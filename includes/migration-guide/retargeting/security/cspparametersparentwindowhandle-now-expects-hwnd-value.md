### <a name="cspparametersparentwindowhandle-now-expects-hwnd-value"></a><span data-ttu-id="74bf6-101">CspParameters.ParentWindowHandle agora espera o valor HWND</span><span class="sxs-lookup"><span data-stu-id="74bf6-101">CspParameters.ParentWindowHandle now expects HWND value</span></span>

|   |   |
|---|---|
|<span data-ttu-id="74bf6-102">Detalhes</span><span class="sxs-lookup"><span data-stu-id="74bf6-102">Details</span></span>|<span data-ttu-id="74bf6-103">O valor <xref:System.Security.Cryptography.CspParameters.ParentWindowHandle>, introduzido no .NET Framework 2.0, permite que um aplicativo registre um valor de identificador de janela pai, de modo que qualquer interface do usuário necessária para acessar a chave (por exemplo, uma caixa de diálogo de solicitação de PIN ou de consentimento) seja aberta como um filho modal para a janela especificada. A partir dos aplicativos destinados ao .NET Framework 4.7, um aplicativo do Windows Forms pode definir a propriedade <xref:System.Security.Cryptography.CspParameters.ParentWindowHandle> com código como o seguinte:</span><span class="sxs-lookup"><span data-stu-id="74bf6-103">The <xref:System.Security.Cryptography.CspParameters.ParentWindowHandle> value, introduced in .NET Framework 2.0, allows an application to register a parent window handle value such that any UI required to access the key (such as a PIN prompt or consent dialog) opens as a modal child to the specified window.Starting with apps that target the .NET Framework 4.7, a Windows Forms application can set the <xref:System.Security.Cryptography.CspParameters.ParentWindowHandle> property with code like the following:</span></span><pre><code class="lang-csharp">cspParameters.ParentWindowHandle = form.Handle;&#13;&#10;</code></pre><span data-ttu-id="74bf6-104">Em versões anteriores do .NET Framework, esperava-se que o valor fosse um <xref:System.IntPtr?displayProperty=name> representando um local na memória em que o valor de [HWND](https://msdn.microsoft.com/library/windows/desktop/aa383751.aspx#HWND) residia.</span><span class="sxs-lookup"><span data-stu-id="74bf6-104">In previous versions of the .NET Framework, the value was expected to be an <xref:System.IntPtr?displayProperty=name> representing a location in memory where the [HWND](https://msdn.microsoft.com/library/windows/desktop/aa383751.aspx#HWND) value resided.</span></span> <span data-ttu-id="74bf6-105">Definir a propriedade como form.Handle no Windows 7 e em versões anteriores não tinha efeito. No Windows 8 e em versões posteriores, isso resulta em &quot;<xref:System.Security.Cryptography.CryptographicException?displayProperty=name>: O parâmetro está incorreto.&quot;</span><span class="sxs-lookup"><span data-stu-id="74bf6-105">Setting the property to form.Handle on Windows 7 and earlier versions had no effect, but on Windows 8 and later versions, it results in a &quot;<xref:System.Security.Cryptography.CryptographicException?displayProperty=name>: The parameter is incorrect.&quot;</span></span>|
|<span data-ttu-id="74bf6-106">Sugestão</span><span class="sxs-lookup"><span data-stu-id="74bf6-106">Suggestion</span></span>|<span data-ttu-id="74bf6-107">Os aplicativos direcionados ao .NET Framework 4.7 ou posterior que desejam registrar um relacionamento de janela pai são incentivados a usar o formato simplificado:</span><span class="sxs-lookup"><span data-stu-id="74bf6-107">Applications targeting .NET Framework 4.7 or higher wishing to register a parent window relationship are encouraged to use the simplified form:</span></span><pre><code class="lang-csharp">cspParameters.ParentWindowHandle = form.Handle;&#13;&#10;</code></pre><span data-ttu-id="74bf6-108">Usuários que identificaram que o valor correto a ser passado era o endereço de um local da memória que mantinha o valor de <code>form.Handle</code> podem optar por não aceitar essa alteração de comportamento definindo a opção de AppContext <code>Switch.System.Security.Cryptography.DoNotAddrOfCspParentWindowHandle</code> como <code>true</code>.</span><span class="sxs-lookup"><span data-stu-id="74bf6-108">Users who had identified that the correct value to pass was the address of a memory location which held the value <code>form.Handle</code> can opt out of the behavior change by setting the AppContext switch <code>Switch.System.Security.Cryptography.DoNotAddrOfCspParentWindowHandle</code> to <code>true</code>.</span></span><ol><li><span data-ttu-id="74bf6-109">Configurando de forma programática as opções de compatibilidade em AppContext, conforme explicado [aqui](https://blogs.msdn.com/b/dotnet/archive/2015/04/29/net-announcements-at-build-2015.aspx#dotnet46)</span><span class="sxs-lookup"><span data-stu-id="74bf6-109">By programmatically setting compat switches on the AppContext, as explained [here](https://blogs.msdn.com/b/dotnet/archive/2015/04/29/net-announcements-at-build-2015.aspx#dotnet46)</span></span></li><li><span data-ttu-id="74bf6-110">Adicionando a seguinte linha na seção <code>&lt;runtime&gt;</code> do arquivo app.config:</span><span class="sxs-lookup"><span data-stu-id="74bf6-110">By adding the following line to the <code>&lt;runtime&gt;</code> section of the app.config file:</span></span></li></ol><pre><code class="lang-xml">&lt;runtime&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.System.Security.Cryptography.DoNotAddrOfCspParentWindowHandle=true&quot;/&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;</code></pre><span data-ttu-id="74bf6-111">Por outro lado, usuários que quiserem aceitar o novo comportamento no tempo de execução do .NET Framework 4.7 quando o aplicativo for carregado em versões anteriores do .NET Framework podem definir a opção de AppContext como <code>false</code>.</span><span class="sxs-lookup"><span data-stu-id="74bf6-111">Conversely, users who wish to opt in to the new behavior on the .NET Framework 4.7 runtime when the application loads under older .NET Framework versions can set the AppContext switch to <code>false</code>.</span></span>|
|<span data-ttu-id="74bf6-112">Escopo</span><span class="sxs-lookup"><span data-stu-id="74bf6-112">Scope</span></span>|<span data-ttu-id="74bf6-113">Secundário</span><span class="sxs-lookup"><span data-stu-id="74bf6-113">Minor</span></span>|
|<span data-ttu-id="74bf6-114">Versão</span><span class="sxs-lookup"><span data-stu-id="74bf6-114">Version</span></span>|<span data-ttu-id="74bf6-115">4.7</span><span class="sxs-lookup"><span data-stu-id="74bf6-115">4.7</span></span>|
|<span data-ttu-id="74bf6-116">Tipo</span><span class="sxs-lookup"><span data-stu-id="74bf6-116">Type</span></span>|<span data-ttu-id="74bf6-117">Redirecionando</span><span class="sxs-lookup"><span data-stu-id="74bf6-117">Retargeting</span></span>|
|<span data-ttu-id="74bf6-118">APIs afetadas</span><span class="sxs-lookup"><span data-stu-id="74bf6-118">Affected APIs</span></span>|<ul><li><xref:System.Security.Cryptography.CspParameters.ParentWindowHandle?displayProperty=nameWithType></li></ul>|


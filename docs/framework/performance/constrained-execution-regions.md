---
title: Regiões de execução restrita
description: Comece a usar as CER (regiões de execução restrita), que fazem parte de um mecanismo de criação de código gerenciado confiável.
ms.date: 03/30/2017
helpviewer_keywords:
- constrained execution regions
- CERs
ms.assetid: 99354547-39c1-4b0b-8553-938e8f8d1808
ms.openlocfilehash: d928c9357af4a02e389d9ffd5df4ad0195edab06
ms.sourcegitcommit: 0fa2b7b658bf137e813a7f4d09589d64c148ebf5
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/14/2020
ms.locfileid: "86309605"
---
# <a name="constrained-execution-regions"></a><span data-ttu-id="150c9-103">Regiões de execução restrita</span><span class="sxs-lookup"><span data-stu-id="150c9-103">Constrained Execution Regions</span></span>
<span data-ttu-id="150c9-104">Uma CER (região de execução restrita) faz parte de um mecanismo para a criação de código gerenciado confiável.</span><span class="sxs-lookup"><span data-stu-id="150c9-104">A constrained execution region (CER) is part of a mechanism for authoring reliable managed code.</span></span> <span data-ttu-id="150c9-105">A CER define uma área na qual o CLR (Common Language Runtime) é restrito de gerar exceções fora de banda que possam impedir que o código na área seja executado em sua totalidade.</span><span class="sxs-lookup"><span data-stu-id="150c9-105">A CER defines an area in which the common language runtime (CLR) is constrained from throwing out-of-band exceptions that would prevent the code in the area from executing in its entirety.</span></span> <span data-ttu-id="150c9-106">Nessa região, o código do usuário é restrito de executar um código que poderá resultar na geração de exceções fora de banda.</span><span class="sxs-lookup"><span data-stu-id="150c9-106">Within that region, user code is constrained from executing code that would result in the throwing of out-of-band exceptions.</span></span> <span data-ttu-id="150c9-107">O método <xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareConstrainedRegions%2A> deve preceder imediatamente um bloco `try` e marca os blocos `catch`, `finally` e `fault` como regiões de execução restrita.</span><span class="sxs-lookup"><span data-stu-id="150c9-107">The <xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareConstrainedRegions%2A> method must immediately precede a `try` block and marks `catch`, `finally`, and `fault` blocks as constrained execution regions.</span></span> <span data-ttu-id="150c9-108">Depois de marcado como uma região restrita, o código deverá chamar apenas outro código com contratos de confiabilidade forte e o código não deverá alocar nem fazer chamadas virtuais a métodos não preparados ou não confiáveis, a menos que o código esteja preparado para manipular falhas.</span><span class="sxs-lookup"><span data-stu-id="150c9-108">Once marked as a constrained region, code must only call other code with strong reliability contracts, and code should not allocate or make virtual calls to unprepared or unreliable methods unless the code is prepared to handle failures.</span></span> <span data-ttu-id="150c9-109">O CLR atrasa as anulações de thread do código que está sendo executado em uma CER.</span><span class="sxs-lookup"><span data-stu-id="150c9-109">The CLR delays thread aborts for code that is executing in a CER.</span></span>  

> [!IMPORTANT]
> <span data-ttu-id="150c9-110">Só há suporte para CER no .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="150c9-110">CER is only supported in .NET Framework.</span></span> <span data-ttu-id="150c9-111">Este artigo não se aplica ao .NET Core ou ao .NET 5 e posterior.</span><span class="sxs-lookup"><span data-stu-id="150c9-111">This article doesn't apply to .NET Core or .NET 5 and above.</span></span>

 <span data-ttu-id="150c9-112">As regiões de execução restrita são usadas de formas diferentes no CLR, além de um bloco `try` anotado, especialmente, finalizadores críticos executados em classes derivadas da classe <xref:System.Runtime.ConstrainedExecution.CriticalFinalizerObject> e um código executado com o método <xref:System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup%2A>.</span><span class="sxs-lookup"><span data-stu-id="150c9-112">Constrained execution regions are used in different forms in the CLR in addition to an annotated `try` block, notably critical finalizers executing in classes derived from the <xref:System.Runtime.ConstrainedExecution.CriticalFinalizerObject> class and code executed using the <xref:System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup%2A> method.</span></span>  
  
## <a name="cer-advance-preparation"></a><span data-ttu-id="150c9-113">Preparação antecipada da CER</span><span class="sxs-lookup"><span data-stu-id="150c9-113">CER Advance Preparation</span></span>  
 <span data-ttu-id="150c9-114">O CLR prepara as CERs com antecedência para evitar condições de memória insuficiente.</span><span class="sxs-lookup"><span data-stu-id="150c9-114">The CLR prepares CERs in advance to avoid out-of-memory conditions.</span></span> <span data-ttu-id="150c9-115">A preparação antecipada é necessária para que a CLR não cause uma condição de memória insuficiente durante a compilação Just-In-Time ou o carregamento de tipo.</span><span class="sxs-lookup"><span data-stu-id="150c9-115">Advance preparation is required so the CLR does not cause an out of memory condition during just-in-time compilation or type loading.</span></span>  
  
 <span data-ttu-id="150c9-116">O desenvolvedor deve indicar que uma região de código é uma CER:</span><span class="sxs-lookup"><span data-stu-id="150c9-116">The developer is required to indicate that a code region is a CER:</span></span>  
  
- <span data-ttu-id="150c9-117">A região CER de nível superior e os métodos no grafo de chamadas completo que têm o atributo <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> aplicado são preparados com antecedência.</span><span class="sxs-lookup"><span data-stu-id="150c9-117">The top level CER region and methods in the full call graph that have the <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> attribute applied are prepared in advance.</span></span> <span data-ttu-id="150c9-118">O <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> somente pode indicar garantias de <xref:System.Runtime.ConstrainedExecution.Cer.Success> ou <xref:System.Runtime.ConstrainedExecution.Cer.MayFail>.</span><span class="sxs-lookup"><span data-stu-id="150c9-118">The <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> can only state guarantees of <xref:System.Runtime.ConstrainedExecution.Cer.Success> or <xref:System.Runtime.ConstrainedExecution.Cer.MayFail>.</span></span>  
  
- <span data-ttu-id="150c9-119">A preparação antecipada não pode ser executada para chamadas que não podem ser determinadas estaticamente, como a expedição virtual.</span><span class="sxs-lookup"><span data-stu-id="150c9-119">Advance preparation cannot be performed for calls that cannot be statically determined, such as virtual dispatch.</span></span> <span data-ttu-id="150c9-120">Use o método <xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareMethod%2A> nesses casos.</span><span class="sxs-lookup"><span data-stu-id="150c9-120">Use the <xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareMethod%2A> method in these cases.</span></span> <span data-ttu-id="150c9-121">Ao usar o método <xref:System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup%2A>, o atributo <xref:System.Runtime.ConstrainedExecution.PrePrepareMethodAttribute> deve ser aplicado ao código de limpeza.</span><span class="sxs-lookup"><span data-stu-id="150c9-121">When using the <xref:System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup%2A> method, the <xref:System.Runtime.ConstrainedExecution.PrePrepareMethodAttribute> attribute should be applied to the clean up code.</span></span>  
  
## <a name="constraints"></a><span data-ttu-id="150c9-122">Restrições</span><span class="sxs-lookup"><span data-stu-id="150c9-122">Constraints</span></span>  
 <span data-ttu-id="150c9-123">Os usuários são restritos no tipo de código que podem gravar em uma CER.</span><span class="sxs-lookup"><span data-stu-id="150c9-123">Users are constrained in the type of code they can write in a CER.</span></span> <span data-ttu-id="150c9-124">O código não pode causar uma exceção fora de banda, como as que podem ser o resultado das seguintes operações:</span><span class="sxs-lookup"><span data-stu-id="150c9-124">The code cannot cause an out-of-band exception, such as might result from the following operations:</span></span>  
  
- <span data-ttu-id="150c9-125">Alocação explícita.</span><span class="sxs-lookup"><span data-stu-id="150c9-125">Explicit allocation.</span></span>  
  
- <span data-ttu-id="150c9-126">Conversão boxing.</span><span class="sxs-lookup"><span data-stu-id="150c9-126">Boxing.</span></span>  
  
- <span data-ttu-id="150c9-127">Aquisição de um bloqueio.</span><span class="sxs-lookup"><span data-stu-id="150c9-127">Acquiring a lock.</span></span>  
  
- <span data-ttu-id="150c9-128">Chamada virtual a métodos não preparados.</span><span class="sxs-lookup"><span data-stu-id="150c9-128">Calling unprepared methods virtually.</span></span>  
  
- <span data-ttu-id="150c9-129">Chamada a métodos com um contrato de confiabilidade fraca ou não existente.</span><span class="sxs-lookup"><span data-stu-id="150c9-129">Calling methods with a weak or nonexistent reliability contract.</span></span>  
  
 <span data-ttu-id="150c9-130">No .NET Framework versão 2.0, essas restrições são diretrizes.</span><span class="sxs-lookup"><span data-stu-id="150c9-130">In the .NET Framework version 2.0, these constraints are guidelines.</span></span> <span data-ttu-id="150c9-131">O diagnóstico é fornecido por meio das ferramentas de análise de código.</span><span class="sxs-lookup"><span data-stu-id="150c9-131">Diagnostics are provided through code analysis tools.</span></span>  
  
## <a name="reliability-contracts"></a><span data-ttu-id="150c9-132">Contratos de confiabilidade</span><span class="sxs-lookup"><span data-stu-id="150c9-132">Reliability Contracts</span></span>  
 <span data-ttu-id="150c9-133">O <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> é um atributo personalizado que documenta as garantias de confiabilidade e o estado de corrupção de determinado método.</span><span class="sxs-lookup"><span data-stu-id="150c9-133">The <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> is a custom attribute that documents the reliability guarantees and the corruption state of a given method.</span></span>  
  
### <a name="reliability-guarantees"></a><span data-ttu-id="150c9-134">Garantias de confiabilidade</span><span class="sxs-lookup"><span data-stu-id="150c9-134">Reliability Guarantees</span></span>  
 <span data-ttu-id="150c9-135">As garantias de confiabilidade, representadas pelos valores de enumeração <xref:System.Runtime.ConstrainedExecution.Cer>, indicam o grau de confiabilidade de determinado método:</span><span class="sxs-lookup"><span data-stu-id="150c9-135">Reliability guarantees, represented by <xref:System.Runtime.ConstrainedExecution.Cer> enumeration values, indicate the degree of reliability of a given method:</span></span>  
  
- <span data-ttu-id="150c9-136"><xref:System.Runtime.ConstrainedExecution.Cer.MayFail>.</span><span class="sxs-lookup"><span data-stu-id="150c9-136"><xref:System.Runtime.ConstrainedExecution.Cer.MayFail>.</span></span> <span data-ttu-id="150c9-137">Em condições excepcionais, o método poderá falhar.</span><span class="sxs-lookup"><span data-stu-id="150c9-137">Under exceptional conditions, the method might fail.</span></span> <span data-ttu-id="150c9-138">Nesse caso, o método relata novamente ao método de chamada se ele teve êxito ou falhou.</span><span class="sxs-lookup"><span data-stu-id="150c9-138">In this case, the method reports back to the calling method whether it succeeded or failed.</span></span> <span data-ttu-id="150c9-139">O método deve estar contido em uma CER para garantir que ele possa relatar o valor retornado.</span><span class="sxs-lookup"><span data-stu-id="150c9-139">The method must be contained in a CER to ensure that it can report the return value.</span></span>  
  
- <span data-ttu-id="150c9-140"><xref:System.Runtime.ConstrainedExecution.Cer.None>.</span><span class="sxs-lookup"><span data-stu-id="150c9-140"><xref:System.Runtime.ConstrainedExecution.Cer.None>.</span></span> <span data-ttu-id="150c9-141">O método, tipo ou assembly não tem nenhum conceito de uma CER e, provavelmente, não é seguro de ser chamado em uma CER sem uma mitigação significativa dos danos ao estado.</span><span class="sxs-lookup"><span data-stu-id="150c9-141">The method, type, or assembly has no concept of a CER and is most likely not safe to call within a CER without substantial mitigation from state corruption.</span></span> <span data-ttu-id="150c9-142">Ele não aproveita as garantias da CER.</span><span class="sxs-lookup"><span data-stu-id="150c9-142">It does not take advantage of CER guarantees.</span></span> <span data-ttu-id="150c9-143">Isso significa o seguinte:</span><span class="sxs-lookup"><span data-stu-id="150c9-143">This implies the following:</span></span>  
  
    1. <span data-ttu-id="150c9-144">Em condições excepcionais, o método poderá falhar.</span><span class="sxs-lookup"><span data-stu-id="150c9-144">Under exceptional conditions the method might fail.</span></span>  
  
    2. <span data-ttu-id="150c9-145">O método poderá ou não relatar sua falha.</span><span class="sxs-lookup"><span data-stu-id="150c9-145">The method might or might not report that it failed.</span></span>  
  
    3. <span data-ttu-id="150c9-146">O método não é escrito para usar uma CER, o cenário mais provável.</span><span class="sxs-lookup"><span data-stu-id="150c9-146">The method is not written to use a CER, the most likely scenario.</span></span>  
  
    4. <span data-ttu-id="150c9-147">Se um método, tipo ou assembly não for identificado explicitamente para ter êxito, ele será identificado implicitamente como <xref:System.Runtime.ConstrainedExecution.Cer.None>.</span><span class="sxs-lookup"><span data-stu-id="150c9-147">If a method, type, or assembly is not explicitly identified to succeed, it is implicitly identified as <xref:System.Runtime.ConstrainedExecution.Cer.None>.</span></span>  
  
- <span data-ttu-id="150c9-148"><xref:System.Runtime.ConstrainedExecution.Cer.Success>.</span><span class="sxs-lookup"><span data-stu-id="150c9-148"><xref:System.Runtime.ConstrainedExecution.Cer.Success>.</span></span> <span data-ttu-id="150c9-149">Em condições excepcionais, o método tem a garantia de ter êxito.</span><span class="sxs-lookup"><span data-stu-id="150c9-149">Under exceptional conditions, the method is guaranteed to succeed.</span></span> <span data-ttu-id="150c9-150">Para atingir esse nível de confiabilidade, você sempre deve construir uma CER em torno do método chamado, mesmo quando ele é chamado em uma região fora da CER.</span><span class="sxs-lookup"><span data-stu-id="150c9-150">To achieve this level of reliability you should always construct a CER around the method that is called, even when it is called from within a non-CER region.</span></span> <span data-ttu-id="150c9-151">Um método é bem-sucedido se cumpre a finalidade para a qual se destina, embora o êxito possa ser visto de forma subjetiva.</span><span class="sxs-lookup"><span data-stu-id="150c9-151">A method is successful if it accomplishes what is intended, although success can be viewed subjectively.</span></span> <span data-ttu-id="150c9-152">Por exemplo, a marcação de Count com `ReliabilityContractAttribute(Cer.Success)` significa que quando ele é executado em uma CER, ele sempre retorna uma contagem do número de elementos no <xref:System.Collections.ArrayList> e ele nunca pode deixar os campos internos em um estado indeterminado.</span><span class="sxs-lookup"><span data-stu-id="150c9-152">For example, marking Count with `ReliabilityContractAttribute(Cer.Success)` implies that when it is run under a CER, it always returns a count of the number of elements in the <xref:System.Collections.ArrayList> and it can never leave the internal fields in an undetermined state.</span></span>  <span data-ttu-id="150c9-153">No entanto, o método <xref:System.Threading.Interlocked.CompareExchange%2A> é marcado como êxito também, com o entendimento de que o êxito pode indicar que o valor não pode ser substituído por um novo valor devido a uma condição de corrida.</span><span class="sxs-lookup"><span data-stu-id="150c9-153">However, the <xref:System.Threading.Interlocked.CompareExchange%2A> method is marked as success as well, with the understanding that success may mean the value could not be replaced with a new value due to a race condition.</span></span>  <span data-ttu-id="150c9-154">O ponto principal é que o método se comporta da maneira que está documentado para se comportar e o código da CER não precisa ser escrito para esperar qualquer comportamento incomum além do que um código correto, mas não confiável, poderá ter.</span><span class="sxs-lookup"><span data-stu-id="150c9-154">The key point is that the method behaves in the way it is documented to behave, and CER code does not need to be written to expect any unusual behavior beyond what correct but unreliable code would look like.</span></span>  
  
### <a name="corruption-levels"></a><span data-ttu-id="150c9-155">Níveis de corrupção</span><span class="sxs-lookup"><span data-stu-id="150c9-155">Corruption levels</span></span>  
 <span data-ttu-id="150c9-156">Os níveis de corrupção, representados pelos valores de enumeração <xref:System.Runtime.ConstrainedExecution.Consistency>, indicam o provável nível de danos ao estado em determinado ambiente:</span><span class="sxs-lookup"><span data-stu-id="150c9-156">Corruption levels, represented by <xref:System.Runtime.ConstrainedExecution.Consistency> enumeration values, indicate how much state may be corrupted in a given environment:</span></span>  
  
- <span data-ttu-id="150c9-157"><xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptAppDomain>.</span><span class="sxs-lookup"><span data-stu-id="150c9-157"><xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptAppDomain>.</span></span> <span data-ttu-id="150c9-158">Em condições excepcionais, o CLR (Common Language Runtime) não oferece garantias em relação à consistência de estado no domínio do aplicativo atual.</span><span class="sxs-lookup"><span data-stu-id="150c9-158">Under exceptional conditions, the common language runtime (CLR) makes no guarantees regarding state consistency in the current application domain.</span></span>  
  
- <span data-ttu-id="150c9-159"><xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptInstance>.</span><span class="sxs-lookup"><span data-stu-id="150c9-159"><xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptInstance>.</span></span> <span data-ttu-id="150c9-160">Em condições excepcionais, o método tem a garantia de limitar os danos ao estado na instância atual.</span><span class="sxs-lookup"><span data-stu-id="150c9-160">Under exceptional conditions, the method is guaranteed to limit state corruption to the current instance.</span></span>  
  
- <span data-ttu-id="150c9-161"><xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptProcess>, em condições excepcionais, o CLR não oferece nenhuma garantia em relação à consistência de estado; ou seja, a condição pode corromper o processo.</span><span class="sxs-lookup"><span data-stu-id="150c9-161"><xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptProcess>, Under exceptional conditions, the CLR makes no guarantees regarding state consistency; that is, the condition might corrupt the process.</span></span>  
  
- <span data-ttu-id="150c9-162"><xref:System.Runtime.ConstrainedExecution.Consistency.WillNotCorruptState>.</span><span class="sxs-lookup"><span data-stu-id="150c9-162"><xref:System.Runtime.ConstrainedExecution.Consistency.WillNotCorruptState>.</span></span> <span data-ttu-id="150c9-163">Em condições excepcionais, o método tem a garantia de não corromper o estado.</span><span class="sxs-lookup"><span data-stu-id="150c9-163">Under exceptional conditions, the method is guaranteed not to corrupt state.</span></span>  
  
## <a name="reliability-trycatchfinally"></a><span data-ttu-id="150c9-164">Confiabilidade try/catch/finally</span><span class="sxs-lookup"><span data-stu-id="150c9-164">Reliability try/catch/finally</span></span>  
 <span data-ttu-id="150c9-165">A confiabilidade `try/catch/finally` é um mecanismo de tratamento de exceção com o mesmo nível de garantias de previsibilidade da versão não gerenciada.</span><span class="sxs-lookup"><span data-stu-id="150c9-165">The reliability `try/catch/finally` is an exception handling mechanism with the same level of predictability guarantees as the unmanaged version.</span></span> <span data-ttu-id="150c9-166">O bloco `catch/finally` é a CER.</span><span class="sxs-lookup"><span data-stu-id="150c9-166">The `catch/finally` block is the CER.</span></span> <span data-ttu-id="150c9-167">Os métodos no bloco exigem preparação antecipada e não devem ser interrompíveis.</span><span class="sxs-lookup"><span data-stu-id="150c9-167">Methods in the block require advance preparation and must be noninterruptible.</span></span>  
  
 <span data-ttu-id="150c9-168">No .NET Framework versão 2.0, o código informa o runtime de que um try é confiável chamando <xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareConstrainedRegions%2A> imediatamente antes de um bloco try.</span><span class="sxs-lookup"><span data-stu-id="150c9-168">In the .NET Framework version 2.0, code informs the runtime that a try is reliable by calling <xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareConstrainedRegions%2A> immediately preceding a try block.</span></span> <span data-ttu-id="150c9-169"><xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareConstrainedRegions%2A> é membro do <xref:System.Runtime.CompilerServices.RuntimeHelpers>, uma classe de suporte do compilador.</span><span class="sxs-lookup"><span data-stu-id="150c9-169"><xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareConstrainedRegions%2A> is a member of <xref:System.Runtime.CompilerServices.RuntimeHelpers>, a compiler support class.</span></span> <span data-ttu-id="150c9-170">Chame <xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareConstrainedRegions%2A> diretamente, pendente sua disponibilidade por meio dos compiladores.</span><span class="sxs-lookup"><span data-stu-id="150c9-170">Call <xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareConstrainedRegions%2A> directly pending its availability through compilers.</span></span>  
  
## <a name="noninterruptible-regions"></a><span data-ttu-id="150c9-171">Regiões não interrompíveis</span><span class="sxs-lookup"><span data-stu-id="150c9-171">Noninterruptible Regions</span></span>  
 <span data-ttu-id="150c9-172">Uma região não interrompível agrupa um conjunto de instruções em uma CER.</span><span class="sxs-lookup"><span data-stu-id="150c9-172">A noninterruptible region groups a set of instructions into a CER.</span></span>  
  
 <span data-ttu-id="150c9-173">No .NET Framework versão 2.0, pendente disponibilidade por meio do suporte de compilador, o código do usuário cria regiões não interrompíveis com um try/catch/finally confiável que contém um bloco try/catch vazio precedido por uma chamada de método <xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareConstrainedRegions%2A>.</span><span class="sxs-lookup"><span data-stu-id="150c9-173">In .NET Framework version 2.0, pending availability through compiler support, user code creates non-interruptible regions with a reliable try/catch/finally that contains an empty try/catch block preceded by a <xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareConstrainedRegions%2A> method call.</span></span>  
  
## <a name="critical-finalizer-object"></a><span data-ttu-id="150c9-174">Objeto do finalizador crítico</span><span class="sxs-lookup"><span data-stu-id="150c9-174">Critical Finalizer Object</span></span>  
 <span data-ttu-id="150c9-175">Um <xref:System.Runtime.ConstrainedExecution.CriticalFinalizerObject> garante que a coleta de lixo executará o finalizador.</span><span class="sxs-lookup"><span data-stu-id="150c9-175">A <xref:System.Runtime.ConstrainedExecution.CriticalFinalizerObject> guarantees that garbage collection will execute the finalizer.</span></span> <span data-ttu-id="150c9-176">Após a alocação, o finalizador e seu grafo de chamadas são preparados com antecedência.</span><span class="sxs-lookup"><span data-stu-id="150c9-176">Upon allocation, the finalizer and its call graph are prepared in advance.</span></span> <span data-ttu-id="150c9-177">O método do finalizador é executado em uma CER e deve respeitar todas as restrições nas CERs e nos finalizadores.</span><span class="sxs-lookup"><span data-stu-id="150c9-177">The finalizer method executes in a CER, and must obey all the constraints on CERs and finalizers.</span></span>  
  
 <span data-ttu-id="150c9-178">Os tipos que herdam <xref:System.Runtime.InteropServices.SafeHandle> e <xref:System.Runtime.InteropServices.CriticalHandle> têm a garantia de que seu finalizador será executado em uma CER.</span><span class="sxs-lookup"><span data-stu-id="150c9-178">Any types inheriting from <xref:System.Runtime.InteropServices.SafeHandle> and <xref:System.Runtime.InteropServices.CriticalHandle> are guaranteed to have their finalizer execute within a CER.</span></span> <span data-ttu-id="150c9-179">Implemente <xref:System.Runtime.InteropServices.SafeHandle.ReleaseHandle%2A> nas classes derivadas <xref:System.Runtime.InteropServices.SafeHandle> para executar qualquer código que deve liberar o identificador.</span><span class="sxs-lookup"><span data-stu-id="150c9-179">Implement <xref:System.Runtime.InteropServices.SafeHandle.ReleaseHandle%2A> in <xref:System.Runtime.InteropServices.SafeHandle> derived classes to execute any code that is required to free the handle.</span></span>  
  
## <a name="code-not-permitted-in-cers"></a><span data-ttu-id="150c9-180">Código não permitido em CERs</span><span class="sxs-lookup"><span data-stu-id="150c9-180">Code Not Permitted in CERs</span></span>  
 <span data-ttu-id="150c9-181">As seguintes operações não são permitidas em CERs:</span><span class="sxs-lookup"><span data-stu-id="150c9-181">The following operations are not permitted in CERs:</span></span>  
  
- <span data-ttu-id="150c9-182">Alocações explícitas.</span><span class="sxs-lookup"><span data-stu-id="150c9-182">Explicit allocations.</span></span>  
  
- <span data-ttu-id="150c9-183">Aquisição de um bloqueio.</span><span class="sxs-lookup"><span data-stu-id="150c9-183">Acquiring a lock.</span></span>  
  
- <span data-ttu-id="150c9-184">Conversão boxing.</span><span class="sxs-lookup"><span data-stu-id="150c9-184">Boxing.</span></span>  
  
- <span data-ttu-id="150c9-185">Acesso de matriz multidimensional.</span><span class="sxs-lookup"><span data-stu-id="150c9-185">Multidimensional array access.</span></span>  
  
- <span data-ttu-id="150c9-186">Chamadas de método por meio de reflexão.</span><span class="sxs-lookup"><span data-stu-id="150c9-186">Method calls through reflection.</span></span>  
  
- <span data-ttu-id="150c9-187"><xref:System.Threading.Monitor.Enter%2A> ou <xref:System.IO.FileStream.Lock%2A>.</span><span class="sxs-lookup"><span data-stu-id="150c9-187"><xref:System.Threading.Monitor.Enter%2A> or <xref:System.IO.FileStream.Lock%2A>.</span></span>  
  
- <span data-ttu-id="150c9-188">Verificações de segurança.</span><span class="sxs-lookup"><span data-stu-id="150c9-188">Security checks.</span></span> <span data-ttu-id="150c9-189">Não execute demandas, apenas demandas de link.</span><span class="sxs-lookup"><span data-stu-id="150c9-189">Do not perform demands, only link demands.</span></span>  
  
- <span data-ttu-id="150c9-190"><xref:System.Reflection.Emit.OpCodes.Isinst> e <xref:System.Reflection.Emit.OpCodes.Castclass> para objetos COM e proxies</span><span class="sxs-lookup"><span data-stu-id="150c9-190"><xref:System.Reflection.Emit.OpCodes.Isinst> and <xref:System.Reflection.Emit.OpCodes.Castclass> for COM objects and proxies</span></span>  
  
- <span data-ttu-id="150c9-191">Obtenção ou configuração de campos em um proxy transparente.</span><span class="sxs-lookup"><span data-stu-id="150c9-191">Getting or setting fields on a transparent proxy.</span></span>  
  
- <span data-ttu-id="150c9-192">Serialização.</span><span class="sxs-lookup"><span data-stu-id="150c9-192">Serialization.</span></span>  
  
- <span data-ttu-id="150c9-193">Ponteiros de função e representantes.</span><span class="sxs-lookup"><span data-stu-id="150c9-193">Function pointers and delegates.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="150c9-194">Confira também</span><span class="sxs-lookup"><span data-stu-id="150c9-194">See also</span></span>

- [<span data-ttu-id="150c9-195">Práticas recomendadas de confiabilidade</span><span class="sxs-lookup"><span data-stu-id="150c9-195">Reliability Best Practices</span></span>](reliability-best-practices.md)

---
title: Protegendo o WCF Data Services
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- securing application [WCF Data Services]
- WCF Data Services, security
ms.assetid: 99fc2baa-a040-4549-bc4d-f683d60298af
ms.openlocfilehash: 642ff5fe3427509a4d4782fb8640f4b755d58459
ms.sourcegitcommit: d2e1dfa7ef2d4e9ffae3d431cf6a4ffd9c8d378f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/07/2019
ms.locfileid: "70790335"
---
# <a name="securing-wcf-data-services"></a><span data-ttu-id="40bf0-102">Protegendo o WCF Data Services</span><span class="sxs-lookup"><span data-stu-id="40bf0-102">Securing WCF Data Services</span></span>
<span data-ttu-id="40bf0-103">Este tópico descreve as considerações de segurança específicas para desenvolver, implantar e executar WCF Data Services e aplicativos que acessam serviços que dão suporte ao Protocolo Open Data (OData).</span><span class="sxs-lookup"><span data-stu-id="40bf0-103">This topic describes security considerations that are specific to developing, deploying, and running WCF Data Services and applications that access services that support the Open Data Protocol (OData).</span></span> <span data-ttu-id="40bf0-104">Você também deve seguir as recomendações para criar aplicativos de .NET Framework seguros.</span><span class="sxs-lookup"><span data-stu-id="40bf0-104">You should also follow recommendations for creating secure .NET Framework applications.</span></span>  
  
<span data-ttu-id="40bf0-105">Ao planejar como proteger um serviço OData baseado em WCF Data Services, você deve abordar a autenticação, o processo de descoberta e verificação da identidade de uma entidade de segurança e autorização, o processo de determinar se uma entidade autenticada é permissão para acessar os recursos solicitados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-105">When planning how to secure a WCF Data Services-based OData service, you must address both authentication, the process of discovering and verifying the identity of a principal, and authorization, the process of determining whether an authenticated principal is allowed to access the requested resources.</span></span> <span data-ttu-id="40bf0-106">Você também deve considerar a criptografia da mensagem usando o protocolo SSL.</span><span class="sxs-lookup"><span data-stu-id="40bf0-106">You should also consider whether to encrypt the message by using SSL.</span></span>  
  
## <a name="authenticating-client-requests"></a><span data-ttu-id="40bf0-107">Autenticando solicitações de clientes</span><span class="sxs-lookup"><span data-stu-id="40bf0-107">Authenticating Client Requests</span></span>  
<span data-ttu-id="40bf0-108">O WCF Data Services não implementa nenhum tipo de autenticação próprio, mas se baseia nas provisões de autenticação do host do serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-108">WCF Data Services does not implement any kind of authentication of its own, but rather relies on the authentication provisions of the data service host.</span></span> <span data-ttu-id="40bf0-109">Isso significa que o serviço assume que qualquer solicitação recebida já foi autenticada pelo host de rede e que o host identificou corretamente o princípio para a solicitação de forma adequada por meio das interfaces fornecidas pelo WCF Data Services.</span><span class="sxs-lookup"><span data-stu-id="40bf0-109">This means that the service assumes that any request that it receives has already been authenticated by the network host and that the host has correctly identified the principle for the request appropriately via the interfaces provided by WCF Data Services.</span></span> <span data-ttu-id="40bf0-110">Essas opções e abordagens de autenticação são detalhadas na [série de autenticação e OData](https://devblogs.microsoft.com/odata/?s=%22OData+and+authentication%22)de várias partes.</span><span class="sxs-lookup"><span data-stu-id="40bf0-110">These authentication options and approaches are detailed in the multipart [OData and Authentication series](https://devblogs.microsoft.com/odata/?s=%22OData+and+authentication%22).</span></span>  
  
### <a name="authentication-options-for-a-wcf-data-service"></a><span data-ttu-id="40bf0-111">Opções de autenticação para o Serviço de Dados WCF</span><span class="sxs-lookup"><span data-stu-id="40bf0-111">Authentication Options for a WCF Data Service</span></span>  
 <span data-ttu-id="40bf0-112">A tabela a seguir lista alguns dos mecanismos de autenticação que estão disponíveis para ajudá-lo a autenticar solicitações a um Serviço de Dados WCF.</span><span class="sxs-lookup"><span data-stu-id="40bf0-112">The following table lists some of the authentication mechanisms that are available to help you authenticate requests to a WCF Data Service.</span></span>  
  
|<span data-ttu-id="40bf0-113">Opções de autenticação</span><span class="sxs-lookup"><span data-stu-id="40bf0-113">Authentication Options</span></span>|<span data-ttu-id="40bf0-114">Descrição</span><span class="sxs-lookup"><span data-stu-id="40bf0-114">Description</span></span>|  
|----------------------------|-----------------|  
|<span data-ttu-id="40bf0-115">Autenticação anônima</span><span class="sxs-lookup"><span data-stu-id="40bf0-115">Anonymous authentication</span></span>|<span data-ttu-id="40bf0-116">Quando a autenticação anônima HTTP está habilitada, qualquer princípio pode se conectar ao serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-116">When HTTP anonymous authentication is enabled, any principle is able to connect to the data service.</span></span> <span data-ttu-id="40bf0-117">Não são necessárias credenciais para o acesso anônimo.</span><span class="sxs-lookup"><span data-stu-id="40bf0-117">Credentials are not required for anonymous access.</span></span> <span data-ttu-id="40bf0-118">Use esta opção somente quando quiser permitir que qualquer pessoa acesse o serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-118">Use this option only when you want to allow anyone to access the data service.</span></span>|  
|<span data-ttu-id="40bf0-119">Autenticações básica e digest</span><span class="sxs-lookup"><span data-stu-id="40bf0-119">Basic and digest authentication</span></span>|<span data-ttu-id="40bf0-120">As credenciais que consistem em nome de usuário e senha são necessárias para autenticação.</span><span class="sxs-lookup"><span data-stu-id="40bf0-120">Credentials consisting of a user name and password are required for authentication.</span></span> <span data-ttu-id="40bf0-121">Oferecem suporte à autenticação de clientes não Windows.</span><span class="sxs-lookup"><span data-stu-id="40bf0-121">Supports authentication of non-Windows clients.</span></span> <span data-ttu-id="40bf0-122">**Observação de segurança:**  As credenciais da autenticação básica (nome de usuário e senha) são enviadas de modo transparente e podem ser interceptadas.</span><span class="sxs-lookup"><span data-stu-id="40bf0-122">**Security Note:**  Basic authentication credentials (user name and password) are sent in the clear and can be intercepted.</span></span> <span data-ttu-id="40bf0-123">A autenticação digest envia um hash baseado nas credenciais fornecidas, o que a torna mais segura do que a autenticação básica.</span><span class="sxs-lookup"><span data-stu-id="40bf0-123">Digest authentication sends a hash based-on the supplied credentials, which makes it more secure than basic authentication.</span></span> <span data-ttu-id="40bf0-124">Ambas são suscetíveis a ataques do tipo "man-in-the-middle".</span><span class="sxs-lookup"><span data-stu-id="40bf0-124">Both are susceptible to man-in-the-middle attacks.</span></span> <span data-ttu-id="40bf0-125">Ao usar esses métodos de autenticação, você deve considerar a criptografia da comunicação entre o cliente e o serviço de dados usando o protocolo SSL.</span><span class="sxs-lookup"><span data-stu-id="40bf0-125">When using these authentication methods, you should consider encrypting communication between client and the data service by using the Secure Sockets Layer (SSL).</span></span> <br /><br /> <span data-ttu-id="40bf0-126">O Microsoft Serviços de Informações da Internet (IIS) fornece uma implementação de autenticação básica e Digest para solicitações HTTP em um aplicativo ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="40bf0-126">Microsoft Internet Information Services (IIS) provides an implementation of both basic and digest authentication for HTTP requests in an ASP.NET application.</span></span> <span data-ttu-id="40bf0-127">Essa implementação do provedor de Autenticação do Windows permite que um aplicativo cliente do .NET Framework forneça credenciais do cabeçalho HTTP da solicitação ao serviço de dados para negociar perfeitamente a autenticação de um usuário do Windows.</span><span class="sxs-lookup"><span data-stu-id="40bf0-127">This Windows Authentication Provider implementation enables a .NET Framework client application to supply credentials in the HTTP header of the request to the data service to seamlessly negotiate authentication of a Windows user.</span></span> <span data-ttu-id="40bf0-128">Para obter mais informações, consulte [referência técnica de autenticação Digest](https://go.microsoft.com/fwlink/?LinkId=200408).</span><span class="sxs-lookup"><span data-stu-id="40bf0-128">For more information, see [Digest Authentication Technical Reference](https://go.microsoft.com/fwlink/?LinkId=200408).</span></span><br /><br /> <span data-ttu-id="40bf0-129">Quando desejar que seu serviço de dados use a autenticação básica com base em algum serviço de autenticação personalizado e não em credenciais do Windows, você deve implementar um módulo HTTP ADP.NET personalizado para autenticação.</span><span class="sxs-lookup"><span data-stu-id="40bf0-129">When you want to have your data service use basic authentication based on some custom authentication service and not Windows credentials, you must implement a custom ADP.NET HTTP Module for authentication.</span></span><br /><br /> <span data-ttu-id="40bf0-130">Para obter um exemplo de como usar um esquema de autenticação básica personalizado com WCF Data Services, consulte a postagem do blog [OData e Authentication – parte 6 – autenticação básica personalizada](https://devblogs.microsoft.com/odata/odata-and-authentication-part-6-custom-basic-authentication/).</span><span class="sxs-lookup"><span data-stu-id="40bf0-130">For an example of how to use a custom basic authentication scheme with WCF Data Services, see the blog post [OData and Authentication – Part 6 – Custom Basic Authentication](https://devblogs.microsoft.com/odata/odata-and-authentication-part-6-custom-basic-authentication/).</span></span>|  
|<span data-ttu-id="40bf0-131">Autenticação do Windows</span><span class="sxs-lookup"><span data-stu-id="40bf0-131">Windows authentication</span></span>|<span data-ttu-id="40bf0-132">As credenciais baseadas no Windows são trocadas por meio de NTLM ou Kerberos.</span><span class="sxs-lookup"><span data-stu-id="40bf0-132">Windows-based credentials are exchanged by using NTLM or Kerberos.</span></span> <span data-ttu-id="40bf0-133">Esse mecanismo é mais seguro do que a autenticação básica ou digest, mas requer que o cliente seja um aplicativo baseado no Windows.</span><span class="sxs-lookup"><span data-stu-id="40bf0-133">This mechanism is more secure than basic or digest authentication, but it requires that the client be a Windows-based application.</span></span> <span data-ttu-id="40bf0-134">O IIS também fornece uma implementação de autenticação do Windows para solicitações HTTP em um aplicativo ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="40bf0-134">IIS also provides an implementation of Windows authentication for HTTP requests in an ASP.NET application.</span></span> <span data-ttu-id="40bf0-135">Para obter mais informações, consulte [visão geral da autenticação do ASP.net Forms](https://docs.microsoft.com/previous-versions/aspnet/7t6b43z4(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="40bf0-135">For more information, see [ASP.NET Forms Authentication Overview](https://docs.microsoft.com/previous-versions/aspnet/7t6b43z4(v=vs.100)).</span></span><br /><br /> <span data-ttu-id="40bf0-136">Para obter um exemplo de como usar a autenticação do Windows com WCF Data Services, consulte a postagem do blog [OData e Authentication – parte 2 – autenticação do Windows](https://devblogs.microsoft.com/odata/odata-and-authentication-part-2-windows-authentication/).</span><span class="sxs-lookup"><span data-stu-id="40bf0-136">For an example of how to use Windows authentication with WCF Data Services, see the blog post [OData and Authentication – Part 2 – Windows Authentication](https://devblogs.microsoft.com/odata/odata-and-authentication-part-2-windows-authentication/).</span></span>|  
|<span data-ttu-id="40bf0-137">Autenticação de formulários do ASP.NET</span><span class="sxs-lookup"><span data-stu-id="40bf0-137">ASP.NET forms authentication</span></span>|<span data-ttu-id="40bf0-138">A autenticação de formulários permite que você autentique usuários usando seu próprio código e, em seguida, mantenha um token de autenticação em um cookie ou na URL da página.</span><span class="sxs-lookup"><span data-stu-id="40bf0-138">Forms authentication lets you authenticate users by using your own code and then maintain an authentication token in a cookie or in the page URL.</span></span> <span data-ttu-id="40bf0-139">Você autentica o nome de usuário e a senha de seus usuários usando um formulário de logon que você cria.</span><span class="sxs-lookup"><span data-stu-id="40bf0-139">You authenticate the user name and password of your users using a login form that you create.</span></span> <span data-ttu-id="40bf0-140">As solicitações não autenticadas são redirecionadas para uma página de logon, onde o usuário fornece credenciais e envia o formulário.</span><span class="sxs-lookup"><span data-stu-id="40bf0-140">Unauthenticated requests are redirected to a login page, where the user provides credentials and submits the form.</span></span> <span data-ttu-id="40bf0-141">Se o aplicativo autenticar a solicitação, o sistema emitirá um tíquete contendo uma chave para restabelecer a identidade para solicitações subsequentes.</span><span class="sxs-lookup"><span data-stu-id="40bf0-141">If the application authenticates the request, the system issues a ticket that contains a key for reestablishing the identity for subsequent requests.</span></span> <span data-ttu-id="40bf0-142">Para obter mais informações, consulte [provedor de autenticação de formulários](https://docs.microsoft.com/previous-versions/aspnet/9wff0kyh(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="40bf0-142">For more information, see [Forms Authentication Provider](https://docs.microsoft.com/previous-versions/aspnet/9wff0kyh(v=vs.100)).</span></span> <span data-ttu-id="40bf0-143">**Observação de segurança:**  Por padrão, o cookie que contém o tíquete de autenticação de formulários não é protegido quando você usa a autenticação de formulários em um aplicativo Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="40bf0-143">**Security Note:**  By default, the cookie that contains the forms authentication ticket is not secured when you use forms authentication in a ASP.NET Web application.</span></span> <span data-ttu-id="40bf0-144">Você deve considerar exigir que o SSL proteja o tíquete de autenticação e as credenciais do logon inicial.</span><span class="sxs-lookup"><span data-stu-id="40bf0-144">You should consider requiring SSL to protect both the authentication ticket and the initial login credentials.</span></span> <br /><br /> <span data-ttu-id="40bf0-145">Para obter um exemplo de como usar a autenticação de formulários com WCF Data Services, consulte a postagem de blog [OData e Authentication – parte 7 – autenticação de formulários](https://devblogs.microsoft.com/odata/odata-and-authentication-part-7-forms-authentication/).</span><span class="sxs-lookup"><span data-stu-id="40bf0-145">For an example of how to use forms authentication with WCF Data Services, see the blog post [OData and Authentication – Part 7 – Forms Authentication](https://devblogs.microsoft.com/odata/odata-and-authentication-part-7-forms-authentication/).</span></span>|  
|<span data-ttu-id="40bf0-146">Autenticação baseada em declarações</span><span class="sxs-lookup"><span data-stu-id="40bf0-146">Claims-based authentication</span></span>|<span data-ttu-id="40bf0-147">Na autenticação baseada em declarações, o serviço de dados depende de um serviço de provedor de identidade confiável "de terceiros" para autenticar o usuário.</span><span class="sxs-lookup"><span data-stu-id="40bf0-147">In claims-based authentication, the data service relies on a trusted "third-party" identity provider service to authenticate the user.</span></span> <span data-ttu-id="40bf0-148">O provedor de identidade positivamente autentica o usuário que está solicitando acesso a recursos do serviço de acesso e emite um token que concede acesso aos recursos solicitados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-148">The identity provider positively authenticates the user that is requesting access to data service resources and issues a token that grants access to the requested resources.</span></span> <span data-ttu-id="40bf0-149">Esse token é então apresentado ao serviço de dados, que concede acesso ao usuário com base na relação de confiança com o serviço de identidade que emitiu o token de acesso.</span><span class="sxs-lookup"><span data-stu-id="40bf0-149">This token is then presented to the data service, which then grants access to the user based on the trust relationship with the identity service that issued the access token.</span></span><br /><br /> <span data-ttu-id="40bf0-150">A vantagem de usar um provedor de autenticação baseado em declarações é que ele pode ser usado para autenticar vários tipos de clientes em domínios de confiança.</span><span class="sxs-lookup"><span data-stu-id="40bf0-150">The benefit of using a claims-based authentication provider is that they can be used to authenticate various types of clients across trust domains.</span></span> <span data-ttu-id="40bf0-151">Empregando tal provedor de terceiros, um serviço de dados pode descarregar os requisitos de manutenção e autenticação de usuários.</span><span class="sxs-lookup"><span data-stu-id="40bf0-151">By employing such a third-party provider, a data service can offload the requirements of maintaining and authenticating users.</span></span> <span data-ttu-id="40bf0-152">OAuth 2.0 é um protocolo de autenticação baseado em declarações que tem o suporte do Microsoft Azure AppFabric Access Control para autorização federada como um serviço.</span><span class="sxs-lookup"><span data-stu-id="40bf0-152">OAuth 2.0 is a claims-based authentication protocol that is supported by Windows Azure AppFabric Access Control for federated authorization as a service.</span></span> <span data-ttu-id="40bf0-153">Esse protocolo oferece suporte a serviços baseados em REST.</span><span class="sxs-lookup"><span data-stu-id="40bf0-153">This protocol supports REST-based services.</span></span> <span data-ttu-id="40bf0-154">Para obter um exemplo de como usar o OAuth 2,0 com WCF Data Services, consulte a postagem do blog [OData e Authentication – parte 8 – OAuth Wrap](https://devblogs.microsoft.com/odata/odata-and-authentication-part-8-oauth-wrap/).</span><span class="sxs-lookup"><span data-stu-id="40bf0-154">For an example of how to use OAuth 2.0 with WCF Data Services, see the blog post [OData and Authentication – Part 8 – OAuth WRAP](https://devblogs.microsoft.com/odata/odata-and-authentication-part-8-oauth-wrap/).</span></span>|  
  
<a name="clientAuthentication"></a>   
### <a name="authentication-in-the-client-library"></a><span data-ttu-id="40bf0-155">Autenticação na biblioteca de cliente</span><span class="sxs-lookup"><span data-stu-id="40bf0-155">Authentication in the Client Library</span></span>  
 <span data-ttu-id="40bf0-156">Por padrão, a biblioteca de cliente WCF Data Services não fornece credenciais ao fazer uma solicitação para um serviço OData.</span><span class="sxs-lookup"><span data-stu-id="40bf0-156">By default, the WCF Data Services client library does not supply credentials when making a request to an OData service.</span></span> <span data-ttu-id="40bf0-157">Quando as credenciais de logon são exigidas pelo serviço de dados para autenticar um usuário, essas credenciais podem ser fornecidas em um <xref:System.Net.NetworkCredential> acessado da propriedade <xref:System.Data.Services.Client.DataServiceContext.Credentials%2A> do <xref:System.Data.Services.Client.DataServiceContext>, como no exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="40bf0-157">When login credentials are required by the data service to authenticate a user, these credentials can be supplied in a <xref:System.Net.NetworkCredential> accessed from the <xref:System.Data.Services.Client.DataServiceContext.Credentials%2A> property of the <xref:System.Data.Services.Client.DataServiceContext>, as in the following example:</span></span>  
  
```csharp  
// Set the client authentication credentials.  
context.Credentials =  
    new NetworkCredential(userName, password, domain);  
```  
  
```vb  
' Set the client authentication credentials.  
context.Credentials = _  
    New NetworkCredential(userName, password, domain)  
```  
  
 <span data-ttu-id="40bf0-158">Para obter mais informações, confira [Como: Especifique as credenciais do cliente para uma solicitação](specify-client-creds-for-a-data-service-request-wcf.md)de serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-158">For more information, see [How to: Specify Client Credentials for a Data Service Request](specify-client-creds-for-a-data-service-request-wcf.md).</span></span>  
  
 <span data-ttu-id="40bf0-159">Quando o serviço de dados exige credenciais de logon que não podem ser especificadas com um objeto <xref:System.Net.NetworkCredential>, como um cookie ou um token baseado em declarações, você deve definir manualmente os cabeçalhos na solicitação HTTP, geralmente os cabeçalhos `Authorization` e `Cookie`.</span><span class="sxs-lookup"><span data-stu-id="40bf0-159">When the data service requires login credentials that cannot be specified by using a <xref:System.Net.NetworkCredential> object, such as a claims-based token or cookie, you must manually set headers in the HTTP request, usually the `Authorization` and `Cookie` headers.</span></span> <span data-ttu-id="40bf0-160">Para obter mais informações sobre esse tipo de cenário de autenticação, consulte a postagem no blog [OData e autenticação – parte 3 – ganchos latência](https://devblogs.microsoft.com/odata/odata-and-authentication-part-3-clientside-hooks/).</span><span class="sxs-lookup"><span data-stu-id="40bf0-160">For more information about this kind of authentication scenario, see the blog post [ OData and Authentication – Part 3 – ClientSide Hooks](https://devblogs.microsoft.com/odata/odata-and-authentication-part-3-clientside-hooks/).</span></span> <span data-ttu-id="40bf0-161">Para obter um exemplo de como definir cabeçalhos HTTP em uma mensagem de solicitação, [consulte Como: Defina os cabeçalhos na solicitação](how-to-set-headers-in-the-client-request-wcf-data-services.md)do cliente.</span><span class="sxs-lookup"><span data-stu-id="40bf0-161">For an example of how to set HTTP headers in a request message, see [How to: Set Headers in the Client Request](how-to-set-headers-in-the-client-request-wcf-data-services.md).</span></span>  
  
## <a name="impersonation"></a><span data-ttu-id="40bf0-162">Representação</span><span class="sxs-lookup"><span data-stu-id="40bf0-162">Impersonation</span></span>  
 <span data-ttu-id="40bf0-163">Em geral, o serviço de dados acessa os recursos necessários, como arquivos no servidor ou em um banco de dados, usando as credenciais do processo de trabalho que está hospedando o serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-163">Generally, the data service accesses required resources, such as files on the server or a database, by using the credentials of the worker process that is hosting the data service.</span></span> <span data-ttu-id="40bf0-164">Ao usar a representação, os aplicativos ASP.NET podem ser executados com a identidade do Windows (conta de usuário) do usuário que faz a solicitação.</span><span class="sxs-lookup"><span data-stu-id="40bf0-164">When using impersonation, ASP.NET applications can execute with the Windows identity (user account) of the user making the request.</span></span> <span data-ttu-id="40bf0-165">A representação é normalmente usada em aplicativos que dependem do IIS para autenticar o usuário, e as credenciais desse princípio são usadas para acessar os recursos necessários.</span><span class="sxs-lookup"><span data-stu-id="40bf0-165">Impersonation is commonly used in applications that rely on IIS to authenticate the user, and the credentials of this principle are used to access the required resources.</span></span> <span data-ttu-id="40bf0-166">Para obter mais informações, consulte [representação ASP.net](https://docs.microsoft.com/previous-versions/aspnet/xh507fc5(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="40bf0-166">For more information, see [ASP.NET Impersonation](https://docs.microsoft.com/previous-versions/aspnet/xh507fc5(v=vs.100)).</span></span>  
  
## <a name="configuring-data-service-authorization"></a><span data-ttu-id="40bf0-167">Configurando a autorização do serviço de dados</span><span class="sxs-lookup"><span data-stu-id="40bf0-167">Configuring Data Service Authorization</span></span>  
 <span data-ttu-id="40bf0-168">Autorização é a concessão de acesso a recursos do aplicativo a um princípio ou processo que é identificado com base em uma autenticação anteriormente bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="40bf0-168">Authorization is the granting of access to application resources to a principle or process that is identified based on a previously successful authentication.</span></span> <span data-ttu-id="40bf0-169">Como uma prática geral, você só deve conceder direitos suficientes para os usuários do serviço de dados executarem as operações exigidas pelos aplicativos cliente.</span><span class="sxs-lookup"><span data-stu-id="40bf0-169">As a general practice, you should only grant sufficient rights to users of the data service to perform the operations required by client applications.</span></span>  
  
### <a name="restrict-access-to-data-service-resources"></a><span data-ttu-id="40bf0-170">Restringir o acesso a recursos do serviço de dados</span><span class="sxs-lookup"><span data-stu-id="40bf0-170">Restrict Access to Data Service Resources</span></span>  
 <span data-ttu-id="40bf0-171">Por padrão, o WCF Data Services permite que você conceda acesso de leitura e gravação comum a recursos do serviço de dados (conjunto de entidades e operações de serviço) a qualquer usuário que possa acessar o serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-171">By default, WCF Data Services enables you to grant common read and write access against data service resources (entity set and service operations) to any user that is able to access the data service.</span></span> <span data-ttu-id="40bf0-172">As regras que definem o acesso de leitura e gravação podem ser definidas separadamente para cada conjunto de entidades exposto pelo serviço de dados, bem como quaisquer operações de serviço.</span><span class="sxs-lookup"><span data-stu-id="40bf0-172">Rules that define read and write access can be defined separately for each entity set exposed by the data service, as well as to any service operations.</span></span> <span data-ttu-id="40bf0-173">Recomendamos a limitação do acesso de leitura e gravação somente aos recursos exigidos pelo aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="40bf0-173">We recommend limiting both read and write access to only the resources required by the client application.</span></span> <span data-ttu-id="40bf0-174">Para obter mais informações, consulte [requisitos mínimos de acesso a recursos](configuring-the-data-service-wcf-data-services.md#accessRequirements).</span><span class="sxs-lookup"><span data-stu-id="40bf0-174">For more information, see [Minimum Resource Access Requirements](configuring-the-data-service-wcf-data-services.md#accessRequirements).</span></span>  
  
### <a name="implement-role-based-interceptors"></a><span data-ttu-id="40bf0-175">Implementar interceptores baseados em função</span><span class="sxs-lookup"><span data-stu-id="40bf0-175">Implement Role-Based Interceptors</span></span>  
 <span data-ttu-id="40bf0-176">Os interceptores permitem que você intercepte solicitações para recursos do serviço de dados antes que elas sejam manipuladas pelo serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-176">Interceptors enable you to intercept requests against data service resources before they are acted on by the data service.</span></span> <span data-ttu-id="40bf0-177">Para obter mais informações, consulte [Interceptors](interceptors-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="40bf0-177">For more information, see [Interceptors](interceptors-wcf-data-services.md).</span></span> <span data-ttu-id="40bf0-178">Os interceptores permitem que você tome decisões de autorização com base no usuário autenticado que está fazendo a solicitação.</span><span class="sxs-lookup"><span data-stu-id="40bf0-178">Interceptors enable you to make authorization decisions based the authenticated user that is making the request.</span></span> <span data-ttu-id="40bf0-179">Para obter um exemplo de como restringir o acesso aos recursos do serviço de dados com base em uma identidade de [usuário autenticado, consulte Como: Interceptar mensagens](how-to-intercept-data-service-messages-wcf-data-services.md)do serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-179">For an example of how to restrict access to data service resources based on an authenticated user identity, see [How to: Intercept Data Service Messages](how-to-intercept-data-service-messages-wcf-data-services.md).</span></span>  
  
### <a name="restrict-access-to-the-persisted-data-store-and-local-resources"></a><span data-ttu-id="40bf0-180">Restringir o acesso aos recursos locais e do repositório de dados persistente</span><span class="sxs-lookup"><span data-stu-id="40bf0-180">Restrict Access to the Persisted Data Store and Local Resources</span></span>  
 <span data-ttu-id="40bf0-181">As contas que são usadas para acessar o repositório persistente devem receber somente os direitos suficientes em um banco de dados ou no sistema de arquivos para dar suporte aos requisitos do serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-181">The accounts that are used to access the persisted store should be granted only enough rights in a database or the file system to support the requirements of the data service.</span></span> <span data-ttu-id="40bf0-182">Quando a autenticação anônima é usada, essa é a conta usada para executar o aplicativo de hospedagem.</span><span class="sxs-lookup"><span data-stu-id="40bf0-182">When anonymous authentication is used, this is the account used to run the hosting application.</span></span> <span data-ttu-id="40bf0-183">Para obter mais informações, confira [Como: Desenvolva um serviço de dados WCF em](how-to-develop-a-wcf-data-service-running-on-iis.md)execução no IIS.</span><span class="sxs-lookup"><span data-stu-id="40bf0-183">For more information, see [How to: Develop a WCF Data Service Running on IIS](how-to-develop-a-wcf-data-service-running-on-iis.md).</span></span> <span data-ttu-id="40bf0-184">Quando a representação é usada, os usuários autenticados devem receber acesso a esses recursos, normalmente como parte de um grupo do Windows.</span><span class="sxs-lookup"><span data-stu-id="40bf0-184">When impersonation is used, authenticated users must be granted access to these resources, usually as part of a Windows group.</span></span>  
  
## <a name="other-security-considerations"></a><span data-ttu-id="40bf0-185">Outras considerações de segurança</span><span class="sxs-lookup"><span data-stu-id="40bf0-185">Other Security Considerations</span></span>  
  
### <a name="secure-the-data-in-the-payload"></a><span data-ttu-id="40bf0-186">Proteger os dados na carga</span><span class="sxs-lookup"><span data-stu-id="40bf0-186">Secure the Data in the Payload</span></span>  
<span data-ttu-id="40bf0-187">O OData é baseado no protocolo HTTP.</span><span class="sxs-lookup"><span data-stu-id="40bf0-187">OData is based on the HTTP protocol.</span></span> <span data-ttu-id="40bf0-188">Em uma mensagem HTTP, o cabeçalho pode conter credenciais de usuário valiosas, dependendo da autenticação implementada pelo serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-188">In an HTTP message, the header may contain valuable user credentials, depending on the authentication implemented by the data service.</span></span> <span data-ttu-id="40bf0-189">O corpo da mensagem também pode conter dados importantes do cliente que devem ser protegidos.</span><span class="sxs-lookup"><span data-stu-id="40bf0-189">The message body may also contain valuable customer data that must be protected.</span></span> <span data-ttu-id="40bf0-190">Em ambos os casos, é recomendável que você use o protocolo SSL para proteger essas informações durante a transmissão.</span><span class="sxs-lookup"><span data-stu-id="40bf0-190">In both of these cases, we recommend that you use SSL to protect this information over the wire.</span></span>  
  
### <a name="ignored-message-headers-and-cookies"></a><span data-ttu-id="40bf0-191">Cabeçalhos e cookies de mensagens ignorados</span><span class="sxs-lookup"><span data-stu-id="40bf0-191">Ignored Message Headers and Cookies</span></span>  
 <span data-ttu-id="40bf0-192">Os cabeçalhos de solicitações HTTP, a não ser os que declaram tipos de conteúdo e locais de recursos, são ignorados e nunca são definidos pelo serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-192">HTTP request headers, other than those that declare content types and resource locations, are ignored and are never set by the data service.</span></span>  
  
 <span data-ttu-id="40bf0-193">Os cookies podem ser usados como parte de um esquema de autenticação, como com a autenticação de formulários do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="40bf0-193">Cookies can be used as part of an authentication scheme, such as with ASP.NET Forms Authentication.</span></span> <span data-ttu-id="40bf0-194">No entanto, todos os cookies HTTP definidos em uma solicitação de entrada são ignorados pelo WCF dataservices.</span><span class="sxs-lookup"><span data-stu-id="40bf0-194">However, any HTTP cookies set on an incoming request are ignored by WCF DataServices.</span></span> <span data-ttu-id="40bf0-195">O host de um serviço de dados pode processar o cookie, mas o tempo de execução de WCF Data Services nunca analisa ou retorna cookies.</span><span class="sxs-lookup"><span data-stu-id="40bf0-195">The host of a data service may process the cookie, but the WCF Data Services runtime never analyzes or returns cookies.</span></span> <span data-ttu-id="40bf0-196">A biblioteca de cliente WCF Data Services também não processa cookies enviados na resposta.</span><span class="sxs-lookup"><span data-stu-id="40bf0-196">The WCF Data Services client library also does not process cookies sent in the response.</span></span>  
  
### <a name="custom-hosting-requirements"></a><span data-ttu-id="40bf0-197">Requisitos de hospedagem personalizada</span><span class="sxs-lookup"><span data-stu-id="40bf0-197">Custom Hosting Requirements</span></span>  
 <span data-ttu-id="40bf0-198">Por padrão, WCF Data Services é criada como um aplicativo ASP.NET hospedado no IIS.</span><span class="sxs-lookup"><span data-stu-id="40bf0-198">By default, WCF Data Services is created as an ASP.NET application hosted in IIS.</span></span> <span data-ttu-id="40bf0-199">Isso permite que o serviço de dados aproveite os comportamentos seguros da plataforma.</span><span class="sxs-lookup"><span data-stu-id="40bf0-199">This enables the data service to leverage the secure behaviors of this platform.</span></span> <span data-ttu-id="40bf0-200">Você pode definir WCF Data Services que são hospedados por um host personalizado.</span><span class="sxs-lookup"><span data-stu-id="40bf0-200">You can define WCF Data Services that are hosted by a custom host.</span></span> <span data-ttu-id="40bf0-201">Para obter mais informações, consulte [hospedando o serviço de dados](hosting-the-data-service-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="40bf0-201">For more information, see [Hosting the Data Service](hosting-the-data-service-wcf-data-services.md).</span></span> <span data-ttu-id="40bf0-202">Os componentes e a plataforma que hospedam um serviço de dados devem garantir os seguintes comportamentos de segurança para evitar ataques no serviço de dados:</span><span class="sxs-lookup"><span data-stu-id="40bf0-202">The components and platform hosting a data service must ensure the following security behaviors to prevent attacks on the data service:</span></span>  
  
- <span data-ttu-id="40bf0-203">Limitar o tamanho do URI aceito em uma solicitação do serviço de dados para todas as operações possíveis.</span><span class="sxs-lookup"><span data-stu-id="40bf0-203">Limit the length of the URI accepted in a data service request for all possible operations.</span></span>  
  
- <span data-ttu-id="40bf0-204">Limitar o tamanho de mensagens HTTP de entrada e saída.</span><span class="sxs-lookup"><span data-stu-id="40bf0-204">Limit the size of both incoming and outgoing HTTP messages.</span></span>  
  
- <span data-ttu-id="40bf0-205">Limitar o número total de solicitações pendentes em qualquer momento determinado.</span><span class="sxs-lookup"><span data-stu-id="40bf0-205">Limit the total number of outstanding requests at any given time.</span></span>  
  
- <span data-ttu-id="40bf0-206">Limite o tamanho dos cabeçalhos HTTP e seus valores e forneça WCF Data Services acesso aos dados de cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="40bf0-206">Limit the size of HTTP headers and their values, and provide WCF Data Services access to header data.</span></span>  
  
- <span data-ttu-id="40bf0-207">Detectar e deter ataques conhecidos, como ataques de mensagem de repetição e SYN TCP.</span><span class="sxs-lookup"><span data-stu-id="40bf0-207">Detect and counter known attacks, such as TCP SYN and message replay attacks.</span></span>  
  
### <a name="values-are-not-further-encoded"></a><span data-ttu-id="40bf0-208">Os valores não têm codificação adicional</span><span class="sxs-lookup"><span data-stu-id="40bf0-208">Values Are Not Further Encoded</span></span>  
 <span data-ttu-id="40bf0-209">Os valores de propriedade enviados ao serviço de dados não são codificados ainda mais pelo tempo de execução WCF Data Services.</span><span class="sxs-lookup"><span data-stu-id="40bf0-209">Property values sent to the data service are not further encoded by the WCF Data Services runtime.</span></span> <span data-ttu-id="40bf0-210">Por exemplo, quando uma propriedade de cadeia de caracteres de uma entidade tem conteúdo HTML formatado, as marcas não são codificadas em HTML pelo serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="40bf0-210">For example, when a string property of an entity contains formatted HTML content, the tags are not HTML encoded by the data service.</span></span> <span data-ttu-id="40bf0-211">O serviço de dados também não faz a codificação adicional de valores de propriedades na resposta.</span><span class="sxs-lookup"><span data-stu-id="40bf0-211">The data service also does not further encode property values in the response.</span></span> <span data-ttu-id="40bf0-212">A biblioteca de cliente também não executa nenhuma codificação adicional.</span><span class="sxs-lookup"><span data-stu-id="40bf0-212">The client library also does not perform any additional encoding.</span></span>  
  
### <a name="considerations-for-client-applications"></a><span data-ttu-id="40bf0-213">Considerações para aplicativos cliente</span><span class="sxs-lookup"><span data-stu-id="40bf0-213">Considerations for Client Applications</span></span>  
 <span data-ttu-id="40bf0-214">As seguintes considerações de segurança se aplicam a aplicativos que usam o cliente WCF Data Services para acessar serviços OData:</span><span class="sxs-lookup"><span data-stu-id="40bf0-214">The following security considerations apply to applications that use the WCF Data Services client to access OData services:</span></span>  
  
- <span data-ttu-id="40bf0-215">A biblioteca de cliente presume que os protocolos usados para acessar o serviço de dados forneçam um nível de segurança adequado.</span><span class="sxs-lookup"><span data-stu-id="40bf0-215">The client library assumes that the protocols used to access the data service provide an appropriate level of security.</span></span>  
  
- <span data-ttu-id="40bf0-216">A biblioteca de cliente usa todos os valores padrão para tempos limite e opções de análise das pilhas de transporte subjacentes fornecidas pela plataforma.</span><span class="sxs-lookup"><span data-stu-id="40bf0-216">The client library uses all the default values for timeouts and parsing options of the underlying platform-provided transport stacks.</span></span>  
  
- <span data-ttu-id="40bf0-217">A biblioteca de cliente não lê nenhuma configuração de arquivos de configuração de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="40bf0-217">The client library does not read any settings from application configuration files.</span></span>  
  
- <span data-ttu-id="40bf0-218">A biblioteca de cliente não implementa nenhum mecanismo de acesso entre domínios.</span><span class="sxs-lookup"><span data-stu-id="40bf0-218">The client library does not implement any cross domain access mechanisms.</span></span> <span data-ttu-id="40bf0-219">Em vez disso, ela depende dos mecanismos fornecidos pela pilha HTTP subjacente.</span><span class="sxs-lookup"><span data-stu-id="40bf0-219">Instead, it relies on the mechanisms provided by the underlying HTTP stack.</span></span>  
  
- <span data-ttu-id="40bf0-220">A biblioteca de cliente não tem nenhum elemento de interface do usuário, e nunca tenta exibir ou renderizar os dados que recebe ou envia.</span><span class="sxs-lookup"><span data-stu-id="40bf0-220">The client library has no user interface elements, and it never tries to display or render the data that it receives or sends.</span></span>  
  
- <span data-ttu-id="40bf0-221">Recomendamos que os aplicativos cliente sempre validem a entrada do usuário, bem como os dados aceitos de serviços não confiáveis.</span><span class="sxs-lookup"><span data-stu-id="40bf0-221">We recommend that client applications always validate user input as well as data accepted from untrusted services.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="40bf0-222">Consulte também</span><span class="sxs-lookup"><span data-stu-id="40bf0-222">See also</span></span>

- <span data-ttu-id="40bf0-223">[Defining WCF Data Services](defining-wcf-data-services.md) (Definindo o WCF Data Services)</span><span class="sxs-lookup"><span data-stu-id="40bf0-223">[Defining WCF Data Services](defining-wcf-data-services.md)</span></span>
- <span data-ttu-id="40bf0-224">[WCF Data Services Client Library](wcf-data-services-client-library.md) (Biblioteca de clientes do WCF Data Services)</span><span class="sxs-lookup"><span data-stu-id="40bf0-224">[WCF Data Services Client Library](wcf-data-services-client-library.md)</span></span>

---
title: Tratamento de erros de E/S no .NET
description: Saiba como lidar com erros de e/s no .NET. Mapeie códigos de erro para exceções, manipule exceções em operações de e/s e manipule IOException.
ms.date: 08/27/2018
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- I/O, exception handling
- I/O, errors
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: 45f3951b727d3b615d8384541ff169e8840acab0
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/09/2020
ms.locfileid: "84599796"
---
# <a name="handling-io-errors-in-net"></a><span data-ttu-id="3a81b-104">Tratamento de erros de E/S no .NET</span><span class="sxs-lookup"><span data-stu-id="3a81b-104">Handling I/O errors in .NET</span></span>

<span data-ttu-id="3a81b-105">Além das exceções que podem ser geradas em qualquer chamada de método (como um <xref:System.OutOfMemoryException> quando um sistema sofre estresse ou um <xref:System.NullReferenceException> devido a um erro do programador), os métodos do sistema de arquivos do .NET podem gerar as seguintes exceções:</span><span class="sxs-lookup"><span data-stu-id="3a81b-105">In addition to the exceptions that can be thrown in any method call (such as an <xref:System.OutOfMemoryException> when a system is stressed or an <xref:System.NullReferenceException> due to programmer error), .NET file system methods can throw the following exceptions:</span></span>

- <span data-ttu-id="3a81b-106"><xref:System.IO.IOException?displayProperty=nameWithType>, a classe base de todos os tipos de exceção <xref:System.IO>.</span><span class="sxs-lookup"><span data-stu-id="3a81b-106"><xref:System.IO.IOException?displayProperty=nameWithType>, the base class of all <xref:System.IO> exception types.</span></span> <span data-ttu-id="3a81b-107">Ela é gerada para erros cujos códigos retornados do sistema operacional não mapeiam diretamente para outro tipo de exceção.</span><span class="sxs-lookup"><span data-stu-id="3a81b-107">It is thrown for errors whose return codes from the operating system don't directly map to any other exception type.</span></span>
- <span data-ttu-id="3a81b-108"><xref:System.IO.FileNotFoundException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3a81b-108"><xref:System.IO.FileNotFoundException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="3a81b-109"><xref:System.IO.DirectoryNotFoundException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3a81b-109"><xref:System.IO.DirectoryNotFoundException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="3a81b-110"><xref:System.IO.DriveNotFoundException??displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3a81b-110"><xref:System.IO.DriveNotFoundException??displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="3a81b-111"><xref:System.IO.PathTooLongException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3a81b-111"><xref:System.IO.PathTooLongException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="3a81b-112"><xref:System.OperationCanceledException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3a81b-112"><xref:System.OperationCanceledException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="3a81b-113"><xref:System.UnauthorizedAccessException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3a81b-113"><xref:System.UnauthorizedAccessException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="3a81b-114"><xref:System.ArgumentException?displayProperty=nameWithType>, gerada para caracteres de caminho inválido no .NET Framework e no .NET Core 2.0 e versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="3a81b-114"><xref:System.ArgumentException?displayProperty=nameWithType>, which is thrown for invalid path characters on .NET Framework and on .NET Core 2.0 and previous versions.</span></span>
- <span data-ttu-id="3a81b-115"><xref:System.NotSupportedException?displayProperty=nameWithType>, gerada para dois-pontos inválidos no .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="3a81b-115"><xref:System.NotSupportedException?displayProperty=nameWithType>, which is thrown for invalid colons in .NET Framework.</span></span>
- <span data-ttu-id="3a81b-116"><xref:System.Security.SecurityException?displayProperty=nameWithType>, gerada para aplicativos em execução em confiança limitada que não têm as permissões necessárias somente no .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="3a81b-116"><xref:System.Security.SecurityException?displayProperty=nameWithType>, which is thrown for applications running in limited trust that lack the necessary permissions on .NET Framework only.</span></span> <span data-ttu-id="3a81b-117">(Confiança total é o padrão no .NET Framework.)</span><span class="sxs-lookup"><span data-stu-id="3a81b-117">(Full trust is the default on .NET Framework.)</span></span>

## <a name="mapping-error-codes-to-exceptions"></a><span data-ttu-id="3a81b-118">Mapeando códigos de erro para exceções</span><span class="sxs-lookup"><span data-stu-id="3a81b-118">Mapping error codes to exceptions</span></span>

<span data-ttu-id="3a81b-119">Como o sistema de arquivos é um recurso de sistema operacional, os métodos de E/S no .NET Core e no .NET Framework encapsulam chamadas ao sistema operacional subjacente.</span><span class="sxs-lookup"><span data-stu-id="3a81b-119">Because the file system is an operating system resource, I/O methods in both .NET Core and .NET Framework wrap calls to the underlying operating system.</span></span> <span data-ttu-id="3a81b-120">Quando ocorre um erro de E/S no código executado pelo sistema operacional, ele retorna informações do erro para o método de E/S do .NET.</span><span class="sxs-lookup"><span data-stu-id="3a81b-120">When an I/O error occurs in code executed by the operating system, the operating system returns error information to the .NET I/O method.</span></span> <span data-ttu-id="3a81b-121">Em seguida, o método converte as informações do erro, normalmente na forma de um código de erro, em um tipo de exceção do .NET.</span><span class="sxs-lookup"><span data-stu-id="3a81b-121">The method then translates the error information, typically in the form of an error code, into a .NET exception type.</span></span> <span data-ttu-id="3a81b-122">Na maioria dos casos, ele faz isso convertendo diretamente o código de erro em seu tipo de exceção correspondente; ele não realiza nenhum mapeamento especial do erro com base no contexto da chamada de método.</span><span class="sxs-lookup"><span data-stu-id="3a81b-122">In most cases, it does this by directly translating the error code into its corresponding exception type; it does not perform any special mapping of the error based on the context of the method call.</span></span>

<span data-ttu-id="3a81b-123">Por exemplo, no sistema operacional Windows, uma chamada de método que retorna um código de erro `ERROR_FILE_NOT_FOUND` (ou 0x02) é mapeada para um <xref:System.IO.FileNotFoundException> e um código de erro `ERROR_PATH_NOT_FOUND` (ou 0x03) é mapeado para um <xref:System.IO.DirectoryNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="3a81b-123">For example, on the Windows operating system, a method call that returns an error code of `ERROR_FILE_NOT_FOUND` (or 0x02) maps to a <xref:System.IO.FileNotFoundException>, and an error code of `ERROR_PATH_NOT_FOUND` (or 0x03) maps to a <xref:System.IO.DirectoryNotFoundException>.</span></span>

<span data-ttu-id="3a81b-124">No entanto, as condições precisas sob as quais o sistema operacional retorna códigos de erro específicos geralmente não são documentadas ou são mal documentadas.</span><span class="sxs-lookup"><span data-stu-id="3a81b-124">However, the precise conditions under which the operating system returns particular error codes is often undocumented or poorly documented.</span></span> <span data-ttu-id="3a81b-125">Em decorrência disso, podem ocorrer exceções inesperadas.</span><span class="sxs-lookup"><span data-stu-id="3a81b-125">As a result, unexpected exceptions can occur.</span></span> <span data-ttu-id="3a81b-126">Por exemplo, como você está trabalhando com um diretório em vez de um arquivo, você esperaria que fornecer um caminho de diretório inválido para o construtor <xref:System.IO.DirectoryInfo.%23ctor%2A> gerasse uma <xref:System.IO.DirectoryNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="3a81b-126">For example, because you are working with a directory rather than a file, you would expect that providing an invalid directory path to the <xref:System.IO.DirectoryInfo.%23ctor%2A> constructor throws a <xref:System.IO.DirectoryNotFoundException>.</span></span> <span data-ttu-id="3a81b-127">No entanto, isso também pode gerar uma <xref:System.IO.FileNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="3a81b-127">However, it may also throw a <xref:System.IO.FileNotFoundException>.</span></span>

## <a name="exception-handling-in-io-operations"></a><span data-ttu-id="3a81b-128">Tratamento de exceções em operações de E/S</span><span class="sxs-lookup"><span data-stu-id="3a81b-128">Exception handling in I/O operations</span></span>

<span data-ttu-id="3a81b-129">Por causa dessa dependência do sistema operacional, condições de exceção idênticas (como o erro de diretório não encontrado em nosso exemplo) podem resultar na geração de toda uma classe de exceções de E/S pelo método de E/S.</span><span class="sxs-lookup"><span data-stu-id="3a81b-129">Because of this reliance on the operating system, identical exception conditions (such as the directory not found error in our example) can result in an I/O method throwing any one of the entire class of I/O exceptions.</span></span> <span data-ttu-id="3a81b-130">Isso significa que, ao chamar APIs de E/S, seu código deve estar preparado para lidar com a maioria ou com todas essas exceções, conforme mostrado na tabela a seguir:</span><span class="sxs-lookup"><span data-stu-id="3a81b-130">This means that, when calling I/O APIs, your code should be prepared to handle most or all of these exceptions, as shown in the following table:</span></span>

| <span data-ttu-id="3a81b-131">Tipo de exceção</span><span class="sxs-lookup"><span data-stu-id="3a81b-131">Exception type</span></span> | <span data-ttu-id="3a81b-132">.NET Core</span><span class="sxs-lookup"><span data-stu-id="3a81b-132">.NET Core</span></span> | <span data-ttu-id="3a81b-133">.NET Framework</span><span class="sxs-lookup"><span data-stu-id="3a81b-133">.NET Framework</span></span> |
|---|---|---|
| <xref:System.IO.IOException> | <span data-ttu-id="3a81b-134">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-134">Yes</span></span> | <span data-ttu-id="3a81b-135">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-135">Yes</span></span> |
| <xref:System.IO.FileNotFoundException> | <span data-ttu-id="3a81b-136">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-136">Yes</span></span> | <span data-ttu-id="3a81b-137">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-137">Yes</span></span> |
| <xref:System.IO.DirectoryNotFoundException> | <span data-ttu-id="3a81b-138">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-138">Yes</span></span> | <span data-ttu-id="3a81b-139">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-139">Yes</span></span> |
| <xref:System.IO.DriveNotFoundException?> | <span data-ttu-id="3a81b-140">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-140">Yes</span></span> | <span data-ttu-id="3a81b-141">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-141">Yes</span></span> |
| <xref:System.IO.PathTooLongException> | <span data-ttu-id="3a81b-142">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-142">Yes</span></span> | <span data-ttu-id="3a81b-143">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-143">Yes</span></span> |
| <xref:System.OperationCanceledException> | <span data-ttu-id="3a81b-144">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-144">Yes</span></span> | <span data-ttu-id="3a81b-145">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-145">Yes</span></span> |
| <xref:System.UnauthorizedAccessException> | <span data-ttu-id="3a81b-146">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-146">Yes</span></span> | <span data-ttu-id="3a81b-147">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-147">Yes</span></span> |
| <xref:System.ArgumentException> | <span data-ttu-id="3a81b-148">.NET Core 2.0 e anterior</span><span class="sxs-lookup"><span data-stu-id="3a81b-148">.NET Core 2.0 and earlier</span></span>| <span data-ttu-id="3a81b-149">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-149">Yes</span></span> |
| <xref:System.NotSupportedException> | <span data-ttu-id="3a81b-150">Não</span><span class="sxs-lookup"><span data-stu-id="3a81b-150">No</span></span> | <span data-ttu-id="3a81b-151">Sim</span><span class="sxs-lookup"><span data-stu-id="3a81b-151">Yes</span></span> |
| <xref:System.Security.SecurityException> | <span data-ttu-id="3a81b-152">Não</span><span class="sxs-lookup"><span data-stu-id="3a81b-152">No</span></span> | <span data-ttu-id="3a81b-153">Confiança limitada apenas</span><span class="sxs-lookup"><span data-stu-id="3a81b-153">Limited trust only</span></span> |

## <a name="handling-ioexception"></a><span data-ttu-id="3a81b-154">Tratamento IOException</span><span class="sxs-lookup"><span data-stu-id="3a81b-154">Handling IOException</span></span>

<span data-ttu-id="3a81b-155">Como a classe base para exceções no namespace <xref:System.IO>, a <xref:System.IO.IOException> também é gerada para qualquer código de erro que não é mapeado para um tipo de exceção predefinido.</span><span class="sxs-lookup"><span data-stu-id="3a81b-155">As the base class for exceptions in the <xref:System.IO> namespace, <xref:System.IO.IOException> is also thrown for any error code that does not map to a predefined exception type.</span></span> <span data-ttu-id="3a81b-156">Isso significa que ela pode ser gerada por uma operação de E/S.</span><span class="sxs-lookup"><span data-stu-id="3a81b-156">This means that it can be thrown by any I/O operation.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="3a81b-157">Como <xref:System.IO.IOException> é a classe base dos outros tipos de exceção no namespace <xref:System.IO>, você deve tratar em um bloco `catch` depois de lidar com as outras exceções relacionadas a E/S.</span><span class="sxs-lookup"><span data-stu-id="3a81b-157">Because <xref:System.IO.IOException> is the base class of the other exception types in the <xref:System.IO> namespace, you should handle in a `catch` block after you've handled the other I/O-related exceptions.</span></span>

<span data-ttu-id="3a81b-158">Além disso, do .NET Core 2.1 em diante, as verificações de validação da exatidão do caminho (por exemplo, para garantir que os caracteres inválidos não estejam presentes em um caminho) foram removidas, e o runtime gera uma exceção mapeada de um código de erro do sistema operacional, em vez do seu próprio código de validação.</span><span class="sxs-lookup"><span data-stu-id="3a81b-158">In addition, starting with .NET Core 2.1, validation checks for path correctness (for example, to ensure that invalid characters are not present in a path) have been removed, and the runtime throws an exception mapped from an operating system error code rather than from its own validation code.</span></span> <span data-ttu-id="3a81b-159">A exceção com maior probabilidade de ser gerada nesse caso é uma <xref:System.IO.IOException>, embora também possa ser gerado qualquer outro tipo de exceção.</span><span class="sxs-lookup"><span data-stu-id="3a81b-159">The most likely exception to be thrown in this case is an <xref:System.IO.IOException>, although any other exception type could also be thrown.</span></span>

<span data-ttu-id="3a81b-160">Observe que, no seu código de tratamento de exceções, você deve sempre tratar a <xref:System.IO.IOException> por último.</span><span class="sxs-lookup"><span data-stu-id="3a81b-160">Note that, in your exception handling code, you should always handle the <xref:System.IO.IOException> last.</span></span> <span data-ttu-id="3a81b-161">Caso contrário, como ela é a classe base de todas as outras exceções de E/S, os blocos catch de classes derivadas não serão avaliados.</span><span class="sxs-lookup"><span data-stu-id="3a81b-161">Otherwise, because it is the base class of all other IO exceptions, the catch blocks of derived classes will not be evaluated.</span></span>

<span data-ttu-id="3a81b-162">No caso de um <xref:System.IO.IOException>, é possível obter outras informações de erro na propriedade [IOException.HResult](xref:System.Exception.HResult).</span><span class="sxs-lookup"><span data-stu-id="3a81b-162">In the case of an <xref:System.IO.IOException>, you can get additional error information from the [IOException.HResult](xref:System.Exception.HResult) property.</span></span> <span data-ttu-id="3a81b-163">Para converter o valor HResult em um código de erro do Win32, remova os 16 bits superiores do valor de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="3a81b-163">To convert the HResult value to a Win32 error code, you strip out the upper 16 bits of the 32-bit value.</span></span> <span data-ttu-id="3a81b-164">A tabela a seguir lista os códigos de erro que podem ser encapsulados em um <xref:System.IO.IOException>.</span><span class="sxs-lookup"><span data-stu-id="3a81b-164">The following table lists error codes that may be wrapped in an <xref:System.IO.IOException>.</span></span>

| <span data-ttu-id="3a81b-165">HResult</span><span class="sxs-lookup"><span data-stu-id="3a81b-165">HResult</span></span> | <span data-ttu-id="3a81b-166">Constante</span><span class="sxs-lookup"><span data-stu-id="3a81b-166">Constant</span></span> | <span data-ttu-id="3a81b-167">Descrição</span><span class="sxs-lookup"><span data-stu-id="3a81b-167">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="3a81b-168">ERROR_SHARING_VIOLATION</span><span class="sxs-lookup"><span data-stu-id="3a81b-168">ERROR_SHARING_VIOLATION</span></span> | <span data-ttu-id="3a81b-169">32</span><span class="sxs-lookup"><span data-stu-id="3a81b-169">32</span></span> | <span data-ttu-id="3a81b-170">O nome do arquivo está ausente ou o arquivo ou diretório está em uso.</span><span class="sxs-lookup"><span data-stu-id="3a81b-170">The file name is missing, or the file or directory is in use.</span></span> |
| <span data-ttu-id="3a81b-171">ERROR_FILE_EXISTS</span><span class="sxs-lookup"><span data-stu-id="3a81b-171">ERROR_FILE_EXISTS</span></span> | <span data-ttu-id="3a81b-172">80</span><span class="sxs-lookup"><span data-stu-id="3a81b-172">80</span></span> | <span data-ttu-id="3a81b-173">O arquivo já existe.</span><span class="sxs-lookup"><span data-stu-id="3a81b-173">The file already exists.</span></span> |
| <span data-ttu-id="3a81b-174">ERROR_INVALID_PARAMETER</span><span class="sxs-lookup"><span data-stu-id="3a81b-174">ERROR_INVALID_PARAMETER</span></span> | <span data-ttu-id="3a81b-175">87</span><span class="sxs-lookup"><span data-stu-id="3a81b-175">87</span></span> | <span data-ttu-id="3a81b-176">Um argumento fornecido para o método é inválido.</span><span class="sxs-lookup"><span data-stu-id="3a81b-176">An argument supplied to the method is invalid.</span></span> |
| <span data-ttu-id="3a81b-177">ERROR_ALREADY_EXISTS</span><span class="sxs-lookup"><span data-stu-id="3a81b-177">ERROR_ALREADY_EXISTS</span></span> | <span data-ttu-id="3a81b-178">183</span><span class="sxs-lookup"><span data-stu-id="3a81b-178">183</span></span> | <span data-ttu-id="3a81b-179">O arquivo ou diretório já existe.</span><span class="sxs-lookup"><span data-stu-id="3a81b-179">The file or directory already exists.</span></span> |

<span data-ttu-id="3a81b-180">É possível lidar com eles usando uma cláusula `When` em uma instrução catch, como o exemplo a seguir mostra.</span><span class="sxs-lookup"><span data-stu-id="3a81b-180">You can handle these using a `When` clause in a catch statement, as the following example shows.</span></span>

[!code-csharp[io-exception-handling](~/samples/snippets/standard/io/io-exceptions/cs/io-exceptions.cs)]
[!code-vb[io-exception-handling](~/samples/snippets/standard/io/io-exceptions/vb/io-exceptions.vb)]

## <a name="see-also"></a><span data-ttu-id="3a81b-181">Consulte também</span><span class="sxs-lookup"><span data-stu-id="3a81b-181">See also</span></span>

- [<span data-ttu-id="3a81b-182">Tratando e gerando exceções no .NET</span><span class="sxs-lookup"><span data-stu-id="3a81b-182">Handling and throwing exceptions in .NET</span></span>](../exceptions/index.md)
- [<span data-ttu-id="3a81b-183">Tratamento de exceções (biblioteca de paralelismo de tarefas)</span><span class="sxs-lookup"><span data-stu-id="3a81b-183">Exception handling (Task Parallel Library)</span></span>](../parallel-programming/exception-handling-task-parallel-library.md)
- [<span data-ttu-id="3a81b-184">Práticas recomendadas para exceções</span><span class="sxs-lookup"><span data-stu-id="3a81b-184">Best practices for exceptions</span></span>](../exceptions/best-practices-for-exceptions.md)
- [<span data-ttu-id="3a81b-185">Como usar exceções específicas em um bloco catch</span><span class="sxs-lookup"><span data-stu-id="3a81b-185">How to use specific exceptions in a catch block</span></span>](../exceptions/how-to-use-specific-exceptions-in-a-catch-block.md)

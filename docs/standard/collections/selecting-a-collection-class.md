---
title: Selecionando uma classe de coleção
description: Saiba como decidir qual classe de coleção no .NET escolher. A utilização do tipo errado pode restringir o uso da coleção.
ms.date: 03/18/2019
ms.technology: dotnet-standard
helpviewer_keywords:
- last-in-first-out collections
- first-in-first-out collections
- collections [.NET], selecting collection class
- indexed collections
- Collections classes
- grouping data in collections, selecting collection class
ms.assetid: ba049f9a-ce87-4cc4-b319-3f75c8ddac8a
ms.openlocfilehash: 2a3615d5bb404247ec9280ff3c88e2c10a75768b
ms.sourcegitcommit: 4a938327bad8b2e20cabd0f46a9dc50882596f13
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/28/2020
ms.locfileid: "92889329"
---
# <a name="selecting-a-collection-class"></a><span data-ttu-id="988d2-104">Selecionando uma classe de coleção</span><span class="sxs-lookup"><span data-stu-id="988d2-104">Selecting a Collection Class</span></span>

<span data-ttu-id="988d2-105">Certifique-se de escolher sua classe de coleção com cuidado.</span><span class="sxs-lookup"><span data-stu-id="988d2-105">Be sure to choose your collection class carefully.</span></span> <span data-ttu-id="988d2-106">A utilização do tipo errado pode restringir o uso da coleção.</span><span class="sxs-lookup"><span data-stu-id="988d2-106">Using the wrong type can restrict your use of the collection.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="988d2-107">Evite usar os tipos no namespace <xref:System.Collections>.</span><span class="sxs-lookup"><span data-stu-id="988d2-107">Avoid using the types in the <xref:System.Collections> namespace.</span></span> <span data-ttu-id="988d2-108">As versões genéricas e simultâneas das coleções são as recomendadas devido à maior segurança de tipos e outras melhorias.</span><span class="sxs-lookup"><span data-stu-id="988d2-108">The generic and concurrent versions of the collections are recommended because of their greater type safety and other improvements.</span></span>

<span data-ttu-id="988d2-109">Considere as seguintes perguntas:</span><span class="sxs-lookup"><span data-stu-id="988d2-109">Consider the following questions:</span></span>

- <span data-ttu-id="988d2-110">Você precisa de uma lista sequencial em que o elemento normalmente será descartado após seu valor ser recuperado?</span><span class="sxs-lookup"><span data-stu-id="988d2-110">Do you need a sequential list where the element is typically discarded after its value is retrieved?</span></span>

  - <span data-ttu-id="988d2-111">Em caso afirmativo, considere usar a classe <xref:System.Collections.Queue> ou a classe genérica <xref:System.Collections.Generic.Queue%601> caso precise do comportamento PEPS (primeiro a entrar, primeiro a sair).</span><span class="sxs-lookup"><span data-stu-id="988d2-111">If yes, consider using the <xref:System.Collections.Queue> class or the <xref:System.Collections.Generic.Queue%601> generic class if you need first-in, first-out (FIFO) behavior.</span></span> <span data-ttu-id="988d2-112">Considere usar a classe <xref:System.Collections.Stack> ou a classe genérica <xref:System.Collections.Generic.Stack%601> caso precise do comportamento UEPS (último a entrar, primeiro a sair).</span><span class="sxs-lookup"><span data-stu-id="988d2-112">Consider using the <xref:System.Collections.Stack> class or the <xref:System.Collections.Generic.Stack%601> generic class if you need last-in, first-out (LIFO) behavior.</span></span> <span data-ttu-id="988d2-113">Para obter acesso seguro de vários threads, use as versões simultâneas <xref:System.Collections.Concurrent.ConcurrentQueue%601> e <xref:System.Collections.Concurrent.ConcurrentStack%601>.</span><span class="sxs-lookup"><span data-stu-id="988d2-113">For safe access from multiple threads, use the concurrent versions, <xref:System.Collections.Concurrent.ConcurrentQueue%601> and <xref:System.Collections.Concurrent.ConcurrentStack%601>.</span></span> <span data-ttu-id="988d2-114">Para imutabilidade, considere as versões imutáveis <xref:System.Collections.Immutable.ImmutableQueue%601> e <xref:System.Collections.Immutable.ImmutableStack%601> .</span><span class="sxs-lookup"><span data-stu-id="988d2-114">For immutability, consider the immutable versions, <xref:System.Collections.Immutable.ImmutableQueue%601> and <xref:System.Collections.Immutable.ImmutableStack%601>.</span></span>

  - <span data-ttu-id="988d2-115">Caso contrário, considere usar outras coleções.</span><span class="sxs-lookup"><span data-stu-id="988d2-115">If not, consider using the other collections.</span></span>

- <span data-ttu-id="988d2-116">Você precisa acessar os elementos em uma ordem específica, como PEPS, UEPS ou aleatória?</span><span class="sxs-lookup"><span data-stu-id="988d2-116">Do you need to access the elements in a certain order, such as FIFO, LIFO, or random?</span></span>

  - <span data-ttu-id="988d2-117">A <xref:System.Collections.Queue> classe, bem como as <xref:System.Collections.Generic.Queue%601> <xref:System.Collections.Concurrent.ConcurrentQueue%601> classes genéricas,, e <xref:System.Collections.Immutable.ImmutableQueue%601> todas oferecem acesso PEPS.</span><span class="sxs-lookup"><span data-stu-id="988d2-117">The <xref:System.Collections.Queue> class, as well as the <xref:System.Collections.Generic.Queue%601>, <xref:System.Collections.Concurrent.ConcurrentQueue%601>, and <xref:System.Collections.Immutable.ImmutableQueue%601> generic classes all offer FIFO access.</span></span> <span data-ttu-id="988d2-118">Para obter mais informações, consulte [Quando usar uma coleção thread-safe](thread-safe/when-to-use-a-thread-safe-collection.md).</span><span class="sxs-lookup"><span data-stu-id="988d2-118">For more information, see [When to Use a Thread-Safe Collection](thread-safe/when-to-use-a-thread-safe-collection.md).</span></span>

  - <span data-ttu-id="988d2-119">A <xref:System.Collections.Stack> classe, bem como as <xref:System.Collections.Generic.Stack%601> <xref:System.Collections.Concurrent.ConcurrentStack%601> classes genéricas,, e <xref:System.Collections.Immutable.ImmutableStack%601> todas oferecem acesso de UEPS.</span><span class="sxs-lookup"><span data-stu-id="988d2-119">The <xref:System.Collections.Stack> class, as well as the <xref:System.Collections.Generic.Stack%601>, <xref:System.Collections.Concurrent.ConcurrentStack%601>, and <xref:System.Collections.Immutable.ImmutableStack%601> generic classes all offer LIFO access.</span></span> <span data-ttu-id="988d2-120">Para obter mais informações, consulte [Quando usar uma coleção thread-safe](thread-safe/when-to-use-a-thread-safe-collection.md).</span><span class="sxs-lookup"><span data-stu-id="988d2-120">For more information, see [When to Use a Thread-Safe Collection](thread-safe/when-to-use-a-thread-safe-collection.md).</span></span>

  - <span data-ttu-id="988d2-121">A classe genérica <xref:System.Collections.Generic.LinkedList%601> permite o acesso sequencial de ponta a ponta.</span><span class="sxs-lookup"><span data-stu-id="988d2-121">The <xref:System.Collections.Generic.LinkedList%601> generic class allows sequential access either from the head to the tail, or from the tail to the head.</span></span>

- <span data-ttu-id="988d2-122">Você precisa acessar cada elemento pelo índice?</span><span class="sxs-lookup"><span data-stu-id="988d2-122">Do you need to access each element by index?</span></span>

  - <span data-ttu-id="988d2-123">As classes <xref:System.Collections.ArrayList> e <xref:System.Collections.Specialized.StringCollection> e a classe genérica <xref:System.Collections.Generic.List%601> oferecem acesso aos seus elementos pelo índice baseado em zero do elemento.</span><span class="sxs-lookup"><span data-stu-id="988d2-123">The <xref:System.Collections.ArrayList> and <xref:System.Collections.Specialized.StringCollection> classes and the <xref:System.Collections.Generic.List%601> generic class offer access to their elements by the zero-based index of the element.</span></span> <span data-ttu-id="988d2-124">Para imutabilidade, considere as versões genéricas imutáveis <xref:System.Collections.Immutable.ImmutableArray%601> e <xref:System.Collections.Immutable.ImmutableList%601> .</span><span class="sxs-lookup"><span data-stu-id="988d2-124">For immutability, consider the immutable generic versions, <xref:System.Collections.Immutable.ImmutableArray%601> and <xref:System.Collections.Immutable.ImmutableList%601>.</span></span>

  - <span data-ttu-id="988d2-125">As classes <xref:System.Collections.Hashtable>, <xref:System.Collections.SortedList>, <xref:System.Collections.Specialized.ListDictionary> e <xref:System.Collections.Specialized.StringDictionary>, e as classes genéricas <xref:System.Collections.Generic.Dictionary%602> e <xref:System.Collections.Generic.SortedDictionary%602>, oferecem acesso aos seus elementos pela chave do elemento.</span><span class="sxs-lookup"><span data-stu-id="988d2-125">The <xref:System.Collections.Hashtable>, <xref:System.Collections.SortedList>, <xref:System.Collections.Specialized.ListDictionary>, and <xref:System.Collections.Specialized.StringDictionary> classes, and the <xref:System.Collections.Generic.Dictionary%602> and <xref:System.Collections.Generic.SortedDictionary%602> generic classes offer access to their elements by the key of the element.</span></span> <span data-ttu-id="988d2-126">Além disso, há versões imutáveis de vários tipos correspondentes: <xref:System.Collections.Immutable.ImmutableHashSet%601> ,, <xref:System.Collections.Immutable.ImmutableDictionary%602> <xref:System.Collections.Immutable.ImmutableSortedSet%601> e <xref:System.Collections.Immutable.ImmutableSortedDictionary%602> .</span><span class="sxs-lookup"><span data-stu-id="988d2-126">Additionally, there are immutable versions of several corresponding types: <xref:System.Collections.Immutable.ImmutableHashSet%601>, <xref:System.Collections.Immutable.ImmutableDictionary%602>, <xref:System.Collections.Immutable.ImmutableSortedSet%601>, and <xref:System.Collections.Immutable.ImmutableSortedDictionary%602>.</span></span>

  - <span data-ttu-id="988d2-127">As classes <xref:System.Collections.Specialized.NameObjectCollectionBase> e <xref:System.Collections.Specialized.NameValueCollection>, e as classes genéricas <xref:System.Collections.ObjectModel.KeyedCollection%602> e <xref:System.Collections.Generic.SortedList%602>, oferecem acesso aos seus elementos pelo índice baseado em zero ou pela chave do elemento.</span><span class="sxs-lookup"><span data-stu-id="988d2-127">The <xref:System.Collections.Specialized.NameObjectCollectionBase> and <xref:System.Collections.Specialized.NameValueCollection> classes, and the <xref:System.Collections.ObjectModel.KeyedCollection%602> and <xref:System.Collections.Generic.SortedList%602> generic classes offer access to their elements by either the zero-based index or the key of the element.</span></span>

- <span data-ttu-id="988d2-128">Cada elemento conterá um valor, uma combinação de uma chave e um valor ou uma combinação de uma chave e diversos valores?</span><span class="sxs-lookup"><span data-stu-id="988d2-128">Will each element contain one value, a combination of one key and one value, or a combination of one key and multiple values?</span></span>

  - <span data-ttu-id="988d2-129">Um valor: use qualquer uma das coleções baseadas na interface do <xref:System.Collections.IList> ou na interface genérica do <xref:System.Collections.Generic.IList%601>.</span><span class="sxs-lookup"><span data-stu-id="988d2-129">One value: Use any of the collections based on the <xref:System.Collections.IList> interface or the <xref:System.Collections.Generic.IList%601> generic interface.</span></span> <span data-ttu-id="988d2-130">Para uma opção imutável, considere a <xref:System.Collections.Immutable.IImmutableList%601> interface genérica.</span><span class="sxs-lookup"><span data-stu-id="988d2-130">For an immutable option, consider the <xref:System.Collections.Immutable.IImmutableList%601> generic interface.</span></span>

  - <span data-ttu-id="988d2-131">Uma chave e um valor: use qualquer uma das coleções baseadas na interface do <xref:System.Collections.IDictionary> ou na interface genérica do <xref:System.Collections.Generic.IDictionary%602>.</span><span class="sxs-lookup"><span data-stu-id="988d2-131">One key and one value: Use any of the collections based on the <xref:System.Collections.IDictionary> interface or the <xref:System.Collections.Generic.IDictionary%602> generic interface.</span></span> <span data-ttu-id="988d2-132">Para uma opção imutável, considere as <xref:System.Collections.Immutable.IImmutableSet%601> <xref:System.Collections.Immutable.IImmutableDictionary%602> interfaces genéricas ou.</span><span class="sxs-lookup"><span data-stu-id="988d2-132">For an immutable option, consider the <xref:System.Collections.Immutable.IImmutableSet%601> or <xref:System.Collections.Immutable.IImmutableDictionary%602> generic interfaces.</span></span>

  - <span data-ttu-id="988d2-133">Um valor com chave incorporada: use a classe genérica <xref:System.Collections.ObjectModel.KeyedCollection%602>.</span><span class="sxs-lookup"><span data-stu-id="988d2-133">One value with embedded key: Use the <xref:System.Collections.ObjectModel.KeyedCollection%602> generic class.</span></span>

  - <span data-ttu-id="988d2-134">Uma chave e vários valores: use a classe <xref:System.Collections.Specialized.NameValueCollection>.</span><span class="sxs-lookup"><span data-stu-id="988d2-134">One key and multiple values: Use the <xref:System.Collections.Specialized.NameValueCollection> class.</span></span>

- <span data-ttu-id="988d2-135">Você precisa classificar os elementos de forma diferente de como foram inseridos?</span><span class="sxs-lookup"><span data-stu-id="988d2-135">Do you need to sort the elements differently from how they were entered?</span></span>

  - <span data-ttu-id="988d2-136">O <xref:System.Collections.Hashtable> classifica os elementos dele pelos próprios códigos hash.</span><span class="sxs-lookup"><span data-stu-id="988d2-136">The <xref:System.Collections.Hashtable> class sorts its elements by their hash codes.</span></span>

  - <span data-ttu-id="988d2-137">A classe <xref:System.Collections.SortedList> e as classes genéricas <xref:System.Collections.Generic.SortedList%602> e <xref:System.Collections.Generic.SortedDictionary%602> classificam seus elementos pela chave.</span><span class="sxs-lookup"><span data-stu-id="988d2-137">The <xref:System.Collections.SortedList> class, and the <xref:System.Collections.Generic.SortedList%602> and <xref:System.Collections.Generic.SortedDictionary%602> generic classes sort their elements by the key.</span></span> <span data-ttu-id="988d2-138">A ordem de classificação se baseia na implementação da interface <xref:System.Collections.IComparer> da classe <xref:System.Collections.SortedList> e na implementação da interface genérica <xref:System.Collections.Generic.IComparer%601> das classes genéricas <xref:System.Collections.Generic.SortedList%602> e <xref:System.Collections.Generic.SortedDictionary%602>.</span><span class="sxs-lookup"><span data-stu-id="988d2-138">The sort order is based on the implementation of the <xref:System.Collections.IComparer> interface for the <xref:System.Collections.SortedList> class and on the implementation of the <xref:System.Collections.Generic.IComparer%601> generic interface for the <xref:System.Collections.Generic.SortedList%602> and <xref:System.Collections.Generic.SortedDictionary%602> generic classes.</span></span> <span data-ttu-id="988d2-139">Dos dois tipos genéricos, <xref:System.Collections.Generic.SortedDictionary%602> oferece um melhor desempenho do que <xref:System.Collections.Generic.SortedList%602>, enquanto <xref:System.Collections.Generic.SortedList%602> consome menos memória.</span><span class="sxs-lookup"><span data-stu-id="988d2-139">Of the two generic types, <xref:System.Collections.Generic.SortedDictionary%602> offers better performance than <xref:System.Collections.Generic.SortedList%602>, while <xref:System.Collections.Generic.SortedList%602> consumes less memory.</span></span>

  - <span data-ttu-id="988d2-140">O <xref:System.Collections.ArrayList> oferece um método <xref:System.Collections.ArrayList.Sort%2A> que usa uma implementação <xref:System.Collections.IComparer> como parâmetro.</span><span class="sxs-lookup"><span data-stu-id="988d2-140"><xref:System.Collections.ArrayList> provides a <xref:System.Collections.ArrayList.Sort%2A> method that takes an <xref:System.Collections.IComparer> implementation as a parameter.</span></span> <span data-ttu-id="988d2-141">Seu equivalente genérico, a classe genérica <xref:System.Collections.Generic.List%601>, fornece um método <xref:System.Collections.Generic.List%601.Sort%2A> que usa uma implementação da interface genérica <xref:System.Collections.Generic.IComparer%601> como parâmetro.</span><span class="sxs-lookup"><span data-stu-id="988d2-141">Its generic counterpart, the <xref:System.Collections.Generic.List%601> generic class, provides a <xref:System.Collections.Generic.List%601.Sort%2A> method that takes an implementation of the <xref:System.Collections.Generic.IComparer%601> generic interface as a parameter.</span></span>

- <span data-ttu-id="988d2-142">Você precisa de rapidez para pesquisas e recuperação de informações?</span><span class="sxs-lookup"><span data-stu-id="988d2-142">Do you need fast searches and retrieval of information?</span></span>

  - <span data-ttu-id="988d2-143"><xref:System.Collections.Specialized.ListDictionary> é mais rápido do que o <xref:System.Collections.Hashtable> para pequenas coleções (10 itens ou menos).</span><span class="sxs-lookup"><span data-stu-id="988d2-143"><xref:System.Collections.Specialized.ListDictionary> is faster than <xref:System.Collections.Hashtable> for small collections (10 items or fewer).</span></span> <span data-ttu-id="988d2-144">A classe genérica <xref:System.Collections.Generic.Dictionary%602> fornece pesquisa mais rápida do que a classe genérica <xref:System.Collections.Generic.SortedDictionary%602>.</span><span class="sxs-lookup"><span data-stu-id="988d2-144">The <xref:System.Collections.Generic.Dictionary%602> generic class provides faster lookup than the <xref:System.Collections.Generic.SortedDictionary%602> generic class.</span></span> <span data-ttu-id="988d2-145">A implementação com multithread é <xref:System.Collections.Concurrent.ConcurrentDictionary%602>.</span><span class="sxs-lookup"><span data-stu-id="988d2-145">The multi-threaded implementation is <xref:System.Collections.Concurrent.ConcurrentDictionary%602>.</span></span> <span data-ttu-id="988d2-146">O <xref:System.Collections.Concurrent.ConcurrentBag%601> fornece uma inserção com multithread rápida para dados não ordenados.</span><span class="sxs-lookup"><span data-stu-id="988d2-146"><xref:System.Collections.Concurrent.ConcurrentBag%601> provides fast multi-threaded insertion for unordered data.</span></span> <span data-ttu-id="988d2-147">Para obter mais informações sobre os dois tipos de multi-threaded, consulte [Quando usar uma coleção thread-safe](thread-safe/when-to-use-a-thread-safe-collection.md).</span><span class="sxs-lookup"><span data-stu-id="988d2-147">For more information about both multi-threaded types, see [When to Use a Thread-Safe Collection](thread-safe/when-to-use-a-thread-safe-collection.md).</span></span>

- <span data-ttu-id="988d2-148">Você precisa de coleções que aceitem apenas cadeias de caracteres?</span><span class="sxs-lookup"><span data-stu-id="988d2-148">Do you need collections that accept only strings?</span></span>

  - <span data-ttu-id="988d2-149"><xref:System.Collections.Specialized.StringCollection> (com base no <xref:System.Collections.IList>) e <xref:System.Collections.Specialized.StringDictionary> (com base no <xref:System.Collections.IDictionary>) estão no namespace <xref:System.Collections.Specialized>.</span><span class="sxs-lookup"><span data-stu-id="988d2-149"><xref:System.Collections.Specialized.StringCollection> (based on <xref:System.Collections.IList>) and <xref:System.Collections.Specialized.StringDictionary> (based on <xref:System.Collections.IDictionary>) are in the <xref:System.Collections.Specialized> namespace.</span></span>

  - <span data-ttu-id="988d2-150">Além disso, é possível usar qualquer uma das classes genéricas de coleção no namespace <xref:System.Collections.Generic> como coleções de cadeias de caracteres fortemente tipadas especificando a classe <xref:System.String> para seus argumentos de tipo genérico.</span><span class="sxs-lookup"><span data-stu-id="988d2-150">In addition, you can use any of the generic collection classes in the <xref:System.Collections.Generic> namespace as strongly typed string collections by specifying the <xref:System.String> class for their generic type arguments.</span></span> <span data-ttu-id="988d2-151">Por exemplo, você pode declarar uma variável para ser do tipo [lista \<String> ](xref:System.Collections.Generic.List%601) ou [dicionário<cadeia ](xref:System.Collections.Generic.Dictionary%602)de caracteres>.</span><span class="sxs-lookup"><span data-stu-id="988d2-151">For example, you can declare a variable to be of type [List\<String>](xref:System.Collections.Generic.List%601) or [Dictionary<String,String>](xref:System.Collections.Generic.Dictionary%602).</span></span>

## <a name="linq-to-objects-and-plinq"></a><span data-ttu-id="988d2-152">LINQ to Objects e PLINQ</span><span class="sxs-lookup"><span data-stu-id="988d2-152">LINQ to Objects and PLINQ</span></span>

<span data-ttu-id="988d2-153">O LINQ to Objects permite que os desenvolvedores usem consultas LINQ para acessar objetos na memória, desde que o tipo de objeto implemente <xref:System.Collections.IEnumerable> ou <xref:System.Collections.Generic.IEnumerable%601>.</span><span class="sxs-lookup"><span data-stu-id="988d2-153">LINQ to Objects enables developers to use LINQ queries to access in-memory objects as long as the object type implements <xref:System.Collections.IEnumerable> or <xref:System.Collections.Generic.IEnumerable%601>.</span></span> <span data-ttu-id="988d2-154">As consultas LINQ fornecem um padrão comum para acessar dados, são geralmente mais concisas e legíveis que os loops padrão `foreach` e fornecem capacidades de filtragem, ordenação e agrupamento.</span><span class="sxs-lookup"><span data-stu-id="988d2-154">LINQ queries provide a common pattern for accessing data, are typically more concise and readable than standard `foreach` loops, and provide filtering, ordering, and grouping capabilities.</span></span> <span data-ttu-id="988d2-155">Para obter mais informações, confira [LINQ to Objects (C#)](../../csharp/programming-guide/concepts/linq/linq-to-objects.md) e [LINQ to Objects (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md).</span><span class="sxs-lookup"><span data-stu-id="988d2-155">For more information, see [LINQ to Objects (C#)](../../csharp/programming-guide/concepts/linq/linq-to-objects.md) and [LINQ to Objects (Visual Basic)](../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md).</span></span>

<span data-ttu-id="988d2-156">PLINQ fornece uma implementação paralela de LINQ to Objects que pode oferecer uma execução de consulta mais rápida em muitos cenários, por meio do uso mais eficiente dos computadores de vários núcleos.</span><span class="sxs-lookup"><span data-stu-id="988d2-156">PLINQ provides a parallel implementation of LINQ to Objects that can offer faster query execution in many scenarios, through more efficient use of multi-core computers.</span></span> <span data-ttu-id="988d2-157">Para obter mais informações, consulte [PLINQ (Parallel LINQ)](../parallel-programming/introduction-to-plinq.md).</span><span class="sxs-lookup"><span data-stu-id="988d2-157">For more information, see [Parallel LINQ (PLINQ)](../parallel-programming/introduction-to-plinq.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="988d2-158">Veja também</span><span class="sxs-lookup"><span data-stu-id="988d2-158">See also</span></span>

- <xref:System.Collections>
- <xref:System.Collections.Specialized>
- <xref:System.Collections.Generic>
- [<span data-ttu-id="988d2-159">Coleções thread-safe</span><span class="sxs-lookup"><span data-stu-id="988d2-159">Thread-Safe Collections</span></span>](thread-safe/index.md)

---
title: Tipos de referência anuláveis – referência C#
description: Saiba mais sobre os tipos de referência nulos do C# e como usá-los
ms.date: 04/06/2020
ms.openlocfilehash: 274a613a8381a2b7718c9025f51aadb2eb32af36
ms.sourcegitcommit: 870bc4b4087510f6fba3c7b1c0d391f02bcc1f3e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/23/2020
ms.locfileid: "92471857"
---
# <a name="nullable-reference-types-c-reference"></a><span data-ttu-id="8a40f-103">Tipos de referência anuláveis (referência C#)</span><span class="sxs-lookup"><span data-stu-id="8a40f-103">Nullable reference types (C# reference)</span></span>

> [!NOTE]
> <span data-ttu-id="8a40f-104">Este artigo aborda os tipos de referência anuláveis.</span><span class="sxs-lookup"><span data-stu-id="8a40f-104">This article covers nullable reference types.</span></span> <span data-ttu-id="8a40f-105">Você também pode declarar [tipos de valor anulável](nullable-value-types.md).</span><span class="sxs-lookup"><span data-stu-id="8a40f-105">You can also declare [nullable value types](nullable-value-types.md).</span></span>

<span data-ttu-id="8a40f-106">Os tipos de referência anuláveis estão disponíveis a partir do C# 8,0, no código que aceitou um *contexto de reconhecimento anulável*.</span><span class="sxs-lookup"><span data-stu-id="8a40f-106">Nullable reference types are available beginning with C# 8.0, in code that has opted in to a *nullable aware context*.</span></span> <span data-ttu-id="8a40f-107">Tipos de referência anuláveis, os avisos de análise estática nula e o [operador NULL-tolerante](../operators/null-forgiving.md) são recursos de linguagem opcionais.</span><span class="sxs-lookup"><span data-stu-id="8a40f-107">Nullable reference types, the null static analysis warnings, and the [null-forgiving operator](../operators/null-forgiving.md) are optional language features.</span></span> <span data-ttu-id="8a40f-108">Todos estão desativados por padrão.</span><span class="sxs-lookup"><span data-stu-id="8a40f-108">All are turned off by default.</span></span> <span data-ttu-id="8a40f-109">Um *contexto anulável* é controlado no nível do projeto usando as configurações de compilação ou no código usando pragmas.</span><span class="sxs-lookup"><span data-stu-id="8a40f-109">A *nullable context* is controlled at the project level using build settings, or in code using pragmas.</span></span>

 <span data-ttu-id="8a40f-110">Em um contexto de reconhecimento anulável:</span><span class="sxs-lookup"><span data-stu-id="8a40f-110">In a nullable aware context:</span></span>

- <span data-ttu-id="8a40f-111">Uma variável de um tipo de referência `T` deve ser inicializada com não nulo e talvez nunca seja atribuído um valor que possa ser `null` .</span><span class="sxs-lookup"><span data-stu-id="8a40f-111">A variable of a reference type `T` must be initialized with non-null, and may never be assigned a value that may be `null`.</span></span>
- <span data-ttu-id="8a40f-112">Uma variável de um tipo de referência `T?` pode ser inicializada `null` ou atribuída `null` , mas precisa ser verificada `null` antes de remover a referência.</span><span class="sxs-lookup"><span data-stu-id="8a40f-112">A variable of a reference type `T?` may be initialized with `null` or assigned `null`, but is required to be checked against `null` before de-referencing.</span></span>
- <span data-ttu-id="8a40f-113">Uma variável `m` do tipo `T?` é considerada como não nula quando você aplica o operador NULL-tolerante, como em `m!` .</span><span class="sxs-lookup"><span data-stu-id="8a40f-113">A variable `m` of type `T?` is considered to be non-null when you apply the null-forgiving operator, as in `m!`.</span></span>

<span data-ttu-id="8a40f-114">As distinções entre um tipo de referência não anulável `T` e um tipo de referência Anulável `T?` são impostas pela interpretação do compilador das regras anteriores.</span><span class="sxs-lookup"><span data-stu-id="8a40f-114">The distinctions between a non-nullable reference type `T` and a nullable reference type `T?` are enforced by the compiler's interpretation of the preceding rules.</span></span> <span data-ttu-id="8a40f-115">Uma variável do tipo `T` e uma variável do tipo `T?` são representadas pelo mesmo tipo .net.</span><span class="sxs-lookup"><span data-stu-id="8a40f-115">A variable of type `T` and a variable of type `T?` are represented by the same .NET type.</span></span> <span data-ttu-id="8a40f-116">O exemplo a seguir declara uma cadeia de caracteres não anulável e uma cadeia de caracteres anulável e, em seguida, usa o operador NULL-tolerante para atribuir um valor a uma cadeia de caracteres não anulável:</span><span class="sxs-lookup"><span data-stu-id="8a40f-116">The following example declares a non-nullable string and a nullable string, and then uses the null-forgiving operator to assign a value to a non-nullable string:</span></span>

:::code language="csharp" source="snippets/shared/NullableReferenceTypes.cs" id="SnippetCoreSyntax":::

<span data-ttu-id="8a40f-117">As variáveis `notNull` e `nullable` são representadas pelo <xref:System.String> tipo.</span><span class="sxs-lookup"><span data-stu-id="8a40f-117">The variables `notNull` and `nullable` are both represented by the <xref:System.String> type.</span></span> <span data-ttu-id="8a40f-118">Como os tipos não anuláveis e anuláveis são armazenados como o mesmo tipo, há vários locais em que o uso de um tipo de referência anulável não é permitido.</span><span class="sxs-lookup"><span data-stu-id="8a40f-118">Because the non-nullable and nullable types are both stored as the same type, there are several locations where using a nullable reference type isn't allowed.</span></span> <span data-ttu-id="8a40f-119">Em geral, um tipo de referência anulável não pode ser usado como uma classe base ou uma interface implementada.</span><span class="sxs-lookup"><span data-stu-id="8a40f-119">In general, a nullable reference type can't be used as a base class or implemented interface.</span></span> <span data-ttu-id="8a40f-120">Um tipo de referência anulável não pode ser usado em qualquer criação de objeto ou expressão de teste de tipo.</span><span class="sxs-lookup"><span data-stu-id="8a40f-120">A nullable reference type can't be used in any object creation or type testing expression.</span></span> <span data-ttu-id="8a40f-121">Um tipo de referência anulável não pode ser o tipo de uma expressão de acesso de membro.</span><span class="sxs-lookup"><span data-stu-id="8a40f-121">A nullable reference type can't be the type of a member access expression.</span></span> <span data-ttu-id="8a40f-122">Os exemplos a seguir mostram essas construções:</span><span class="sxs-lookup"><span data-stu-id="8a40f-122">The following examples show these constructs:</span></span>

```csharp
public MyClass : System.Object? // not allowed
{
}

var nullEmpty = System.String?.Empty; // Not allowed
var maybeObject = new object?(); // Not allowed
try
{
    if (thing is string? nullableString) // not allowed
        Console.WriteLine(nullableString);
} catch (Exception? e) // Not Allowed
{
    Console.WriteLine("error");
}
```

## <a name="nullable-references-and-static-analysis"></a><span data-ttu-id="8a40f-123">Referências anuláveis e análise estática</span><span class="sxs-lookup"><span data-stu-id="8a40f-123">Nullable references and static analysis</span></span>

<span data-ttu-id="8a40f-124">Os exemplos na seção anterior ilustram a natureza dos tipos de referência anuláveis.</span><span class="sxs-lookup"><span data-stu-id="8a40f-124">The examples in the previous section illustrate the nature of nullable reference types.</span></span> <span data-ttu-id="8a40f-125">Tipos de referência anuláveis não são novos tipos de classe, mas sim anotações em tipos de referência existentes.</span><span class="sxs-lookup"><span data-stu-id="8a40f-125">Nullable reference types aren't new class types, but rather annotations on existing reference types.</span></span> <span data-ttu-id="8a40f-126">O compilador usa essas anotações para ajudá-lo a encontrar possíveis erros de referência nula em seu código.</span><span class="sxs-lookup"><span data-stu-id="8a40f-126">The compiler uses those annotations to help you find potential null reference errors in your code.</span></span> <span data-ttu-id="8a40f-127">Não há nenhuma diferença de tempo de execução entre um tipo de referência não anulável e um tipo de referência anulável.</span><span class="sxs-lookup"><span data-stu-id="8a40f-127">There's no runtime difference between a non-nullable reference type and a nullable reference type.</span></span> <span data-ttu-id="8a40f-128">O compilador não adiciona nenhuma verificação de tempo de execução para tipos de referência não anuláveis.</span><span class="sxs-lookup"><span data-stu-id="8a40f-128">The compiler doesn't add any runtime checking for non-nullable reference types.</span></span> <span data-ttu-id="8a40f-129">Os benefícios estão na análise de tempo de compilação.</span><span class="sxs-lookup"><span data-stu-id="8a40f-129">The benefits are in the compile-time analysis.</span></span> <span data-ttu-id="8a40f-130">O compilador gera avisos que ajudam a localizar e corrigir possíveis erros nulos em seu código.</span><span class="sxs-lookup"><span data-stu-id="8a40f-130">The compiler generates warnings that help you find and fix potential null errors in your code.</span></span> <span data-ttu-id="8a40f-131">Você declara sua intenção e o compilador avisa quando seu código viola essa intenção.</span><span class="sxs-lookup"><span data-stu-id="8a40f-131">You declare your intent, and the compiler warns you when your code violates that intent.</span></span>

<span data-ttu-id="8a40f-132">Em um contexto habilitado para permite valor nulo, o compilador executa uma análise estática em variáveis de qualquer tipo de referência, tanto anulável quanto não anulável.</span><span class="sxs-lookup"><span data-stu-id="8a40f-132">In a nullable enabled context, the compiler performs static analysis on variables of any reference type, both nullable and non-nullable.</span></span> <span data-ttu-id="8a40f-133">O compilador rastreia o estado nulo de cada variável de referência como *não nulo* ou *talvez seja nulo*.</span><span class="sxs-lookup"><span data-stu-id="8a40f-133">The compiler tracks the null state of each reference variable as either *not null* or *maybe null*.</span></span> <span data-ttu-id="8a40f-134">O estado padrão de uma referência não anulável não é *nulo*.</span><span class="sxs-lookup"><span data-stu-id="8a40f-134">The default state of a non-nullable reference is *not null*.</span></span> <span data-ttu-id="8a40f-135">O estado padrão de uma referência anulável é *talvez nulo*.</span><span class="sxs-lookup"><span data-stu-id="8a40f-135">The default state of a nullable reference is *maybe null*.</span></span>

<span data-ttu-id="8a40f-136">Os tipos de referência não anuláveis devem sempre ser seguros para desreferenciar porque seu estado nulo *não é nulo*.</span><span class="sxs-lookup"><span data-stu-id="8a40f-136">Non-nullable reference types should always be safe to dereference because their null state is *not null*.</span></span> <span data-ttu-id="8a40f-137">Para impor essa regra, o compilador emite avisos se um tipo de referência não anulável não é inicializado para um valor não nulo.</span><span class="sxs-lookup"><span data-stu-id="8a40f-137">To enforce that rule, the compiler issues warnings if a non-nullable reference type isn't initialized to a non-null value.</span></span> <span data-ttu-id="8a40f-138">As variáveis locais devem ser atribuídas onde estiverem declaradas.</span><span class="sxs-lookup"><span data-stu-id="8a40f-138">Local variables must be assigned where they're declared.</span></span> <span data-ttu-id="8a40f-139">Cada construtor deve atribuir cada campo, em seu corpo, em um construtor chamado ou usando um inicializador de campo.</span><span class="sxs-lookup"><span data-stu-id="8a40f-139">Every constructor must assign every field, either in its body, a called constructor, or using a field initializer.</span></span> <span data-ttu-id="8a40f-140">O compilador emite avisos se uma referência não anulável é atribuída a uma referência cujo estado talvez seja *nulo*.</span><span class="sxs-lookup"><span data-stu-id="8a40f-140">The compiler issues warnings if a non-nullable reference is assigned to a reference whose state is *maybe null*.</span></span> <span data-ttu-id="8a40f-141">No entanto, como uma referência não anulável *não é nula*, nenhum aviso é emitido quando essas variáveis são desreferenciadas.</span><span class="sxs-lookup"><span data-stu-id="8a40f-141">However, because a non-nullable reference is *not null*, no warnings are issued when those variables are de-referenced.</span></span>

<span data-ttu-id="8a40f-142">Tipos de referência anuláveis podem ser inicializados ou atribuídos a `null` .</span><span class="sxs-lookup"><span data-stu-id="8a40f-142">Nullable reference types may be initialized or assigned to `null`.</span></span> <span data-ttu-id="8a40f-143">Portanto, a análise estática deve determinar que uma variável *não é nula* antes de ser desreferenciada.</span><span class="sxs-lookup"><span data-stu-id="8a40f-143">Therefore, static analysis must determine that a variable is *not null* before it's dereferenced.</span></span> <span data-ttu-id="8a40f-144">Se uma referência anulável for determinada como *talvez nula*, ela não poderá ser atribuída a uma variável de referência não anulável.</span><span class="sxs-lookup"><span data-stu-id="8a40f-144">If a nullable reference is determined to be *maybe null*, it can't be assigned to a non-nullable reference variable.</span></span> <span data-ttu-id="8a40f-145">A classe a seguir mostra exemplos desses avisos:</span><span class="sxs-lookup"><span data-stu-id="8a40f-145">The following class shows examples of these warnings:</span></span>

:::code language="csharp" source="snippets/shared/NullableReferenceTypes.cs" id="SnippetClassWithNullable":::

<span data-ttu-id="8a40f-146">O trecho a seguir mostra onde o compilador emite avisos ao usar esta classe:</span><span class="sxs-lookup"><span data-stu-id="8a40f-146">The following snippet shows where the compiler emits warnings when using this class:</span></span>

:::code language="csharp" source="snippets/shared/NullableReferenceTypes.cs" id="SnippetLocalWarnings":::

<span data-ttu-id="8a40f-147">Os exemplos anteriores demonstram a análise estática do compilador para determinar o estado nulo de variáveis de referência.</span><span class="sxs-lookup"><span data-stu-id="8a40f-147">The preceding examples demonstrate the compiler's static analysis to determine the null state of reference variables.</span></span> <span data-ttu-id="8a40f-148">O compilador aplica regras de idioma para verificações e atribuições nulas para informar sua análise.</span><span class="sxs-lookup"><span data-stu-id="8a40f-148">The compiler applies language rules for null checks and assignments to inform its analysis.</span></span>  <span data-ttu-id="8a40f-149">O compilador não pode fazer suposições sobre a semântica de métodos ou propriedades.</span><span class="sxs-lookup"><span data-stu-id="8a40f-149">The compiler can't make assumptions about the semantics of methods or properties.</span></span> <span data-ttu-id="8a40f-150">Se você chamar métodos que executam verificações nulas, o compilador não poderá saber que esses métodos afetam o estado nulo de uma variável.</span><span class="sxs-lookup"><span data-stu-id="8a40f-150">If you call methods that perform null checks, the compiler can't know those methods affect a variable's null state.</span></span> <span data-ttu-id="8a40f-151">Há vários atributos que você pode adicionar a suas APIs para informar o compilador sobre a semântica de argumentos e valores de retorno.</span><span class="sxs-lookup"><span data-stu-id="8a40f-151">There are a number of attributes you can add to your APIs to inform the compiler about the semantics of arguments and return values.</span></span> <span data-ttu-id="8a40f-152">Esses atributos foram aplicados a muitas APIs comuns nas bibliotecas do .NET Core.</span><span class="sxs-lookup"><span data-stu-id="8a40f-152">These attributes have been applied to many common APIs in the .NET Core libraries.</span></span> <span data-ttu-id="8a40f-153">Por exemplo, <xref:System.String.IsNullOrEmpty%2A> foi atualizado e o compilador interpreta corretamente esse método como uma verificação nula.</span><span class="sxs-lookup"><span data-stu-id="8a40f-153">For example, <xref:System.String.IsNullOrEmpty%2A> has been updated, and the compiler correctly interprets that method as a null check.</span></span> <span data-ttu-id="8a40f-154">Para obter mais informações sobre os atributos que se aplicam à análise estática de estado nulo, consulte o artigo sobre [atributos anuláveis](../attributes/nullable-analysis.md).</span><span class="sxs-lookup"><span data-stu-id="8a40f-154">For more information about the attributes that apply to null state static analysis, see the article on [Nullable attributes](../attributes/nullable-analysis.md).</span></span>

## <a name="setting-the-nullable-context"></a><span data-ttu-id="8a40f-155">Configurando o contexto anulável</span><span class="sxs-lookup"><span data-stu-id="8a40f-155">Setting the nullable context</span></span>

<span data-ttu-id="8a40f-156">Há duas maneiras de controlar o contexto anulável.</span><span class="sxs-lookup"><span data-stu-id="8a40f-156">There are two ways to control the nullable context.</span></span> <span data-ttu-id="8a40f-157">No nível do projeto, você pode adicionar a `<Nullable>enable</Nullable>` configuração do projeto.</span><span class="sxs-lookup"><span data-stu-id="8a40f-157">At the project level, you can add the `<Nullable>enable</Nullable>` project setting.</span></span> <span data-ttu-id="8a40f-158">Em um único arquivo de origem C#, você pode adicionar o `#nullable enable` pragma para habilitar o contexto anulável.</span><span class="sxs-lookup"><span data-stu-id="8a40f-158">In a single C# source file, you can add the `#nullable enable` pragma to enable the nullable context.</span></span> <span data-ttu-id="8a40f-159">Consulte o artigo sobre como [definir uma estratégia anulável](../../nullable-migration-strategies.md).</span><span class="sxs-lookup"><span data-stu-id="8a40f-159">See the article on [setting a nullable strategy](../../nullable-migration-strategies.md).</span></span>

## <a name="c-language-specification"></a><span data-ttu-id="8a40f-160">Especificação da linguagem C#</span><span class="sxs-lookup"><span data-stu-id="8a40f-160">C# language specification</span></span>

<span data-ttu-id="8a40f-161">Para obter mais informações, consulte as seguintes propostas para a [especificação da linguagem C#](~/_csharplang/spec/introduction.md):</span><span class="sxs-lookup"><span data-stu-id="8a40f-161">For more information, see the following proposals for the [C# language specification](~/_csharplang/spec/introduction.md):</span></span>

- [<span data-ttu-id="8a40f-162">Tipos de referência anuláveis</span><span class="sxs-lookup"><span data-stu-id="8a40f-162">Nullable reference types</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types.md)
- [<span data-ttu-id="8a40f-163">Especificação de tipos de referência Nullable de rascunho</span><span class="sxs-lookup"><span data-stu-id="8a40f-163">Draft nullable reference types specification</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types-specification.md)

## <a name="see-also"></a><span data-ttu-id="8a40f-164">Confira também</span><span class="sxs-lookup"><span data-stu-id="8a40f-164">See also</span></span>

- [<span data-ttu-id="8a40f-165">Referência de C#</span><span class="sxs-lookup"><span data-stu-id="8a40f-165">C# reference</span></span>](../index.md)
- [<span data-ttu-id="8a40f-166">Tipos de valor anulável</span><span class="sxs-lookup"><span data-stu-id="8a40f-166">Nullable value types</span></span>](nullable-value-types.md)
